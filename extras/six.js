(function(global){var Six=function(){function require(path){return require[path]}require["./es6"]=new function(){var exports=this;Object.defineProperties(global.Object,{define:{value:function(target,source){var desc={};Object.keys(source).forEach(function(key){return desc[key]=Object.getOwnPropertyDescriptor(source,key)});Object.defineProperties(target,desc);return target},enumerable:false,writable:true,configurable:true}})};require["./esprima"]=require["./esom/esprima"]=new function(){var exports=this;(function(factory){"use strict";if(typeof define==="function"&&define.amd){define(["exports"],factory)}else if(typeof exports!=="undefined"){factory(exports)}else{factory(window.esprima={})}})(function(exports){"use strict";var Token,TokenName,Syntax,PropertyKind,Messages,Regex,source,strict,yieldAllowed,yieldFound,index,lineNumber,lineStart,length,buffer,state,extra;Token={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,Quasi:9};TokenName={};TokenName[Token.BooleanLiteral]="Boolean";TokenName[Token.EOF]="<end>";TokenName[Token.Identifier]="Identifier";TokenName[Token.Keyword]="Keyword";TokenName[Token.NullLiteral]="Null";TokenName[Token.NumericLiteral]="Numeric";TokenName[Token.Punctuator]="Punctuator";TokenName[Token.StringLiteral]="String";Syntax={ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AssignmentExpression:"AssignmentExpression",BinaryExpression:"BinaryExpression",BlockStatement:"BlockStatement",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",MethodDefinition:"MethodDefinition",ClassHeritage:"ClassHeritage",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportDeclaration:"ExportDeclaration",ExportSpecifier:"ExportSpecifier",ExportSpecifierSet:"ExportSpecifierSet",ExpressionStatement:"ExpressionStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",ForStatement:"ForStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Glob:"Glob",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportSpecifier:"ImportSpecifier",LabeledStatement:"LabeledStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ModuleDeclaration:"ModuleDeclaration",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Path:"Path",Program:"Program",Property:"Property",QuasiElement:"QuasiElement",QuasiLiteral:"QuasiLiteral",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedQuasiExpression:"TaggedQuasiExpression",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"};PropertyKind={Data:1,Get:2,Set:4};Messages={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedQuasi:"Unexpected quasi %0",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",IllegalYield:"Illegal yield expression",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",NoFromAfterImport:"Missing from after import",NoYieldInGenerator:"Missing yield in generator"};Regex={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")};function assert(condition,message){if(!condition){throw new Error("ASSERT: "+message)}}function sliceSource(from,to){return source.slice(from,to)}if(typeof "esprima"[0]==="undefined"){sliceSource=function sliceArraySource(from,to){return source.slice(from,to).join("")}}function isDecimalDigit(ch){return"0123456789".indexOf(ch)>=0}function isHexDigit(ch){return"0123456789abcdefABCDEF".indexOf(ch)>=0}function isOctalDigit(ch){return"01234567".indexOf(ch)>=0}function isWhiteSpace(ch){return ch===" "||ch==="	"||ch===""||ch==="\f"||ch===" "||ch.charCodeAt(0)>=5760&&" ᠎             　﻿".indexOf(ch)>=0}function isLineTerminator(ch){return ch==="\n"||ch==="\r"||ch==="\u2028"||ch==="\u2029"}function isIdentifierStart(ch){return ch==="$"||ch==="_"||ch==="\\"||ch>="a"&&ch<="z"||ch>="A"&&ch<="Z"||ch.charCodeAt(0)>=128&&Regex.NonAsciiIdentifierStart.test(ch)}function isIdentifierPart(ch){return ch==="$"||ch==="_"||ch==="\\"||ch>="a"&&ch<="z"||ch>="A"&&ch<="Z"||ch>="0"&&ch<="9"||ch.charCodeAt(0)>=128&&Regex.NonAsciiIdentifierPart.test(ch)}function isFutureReservedWord(id){switch(id){case"class":case"enum":case"export":case"extends":case"import":case"super":return true}return false}function isStrictModeReservedWord(id){switch(id){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return true}return false}function isRestrictedWord(id){return id==="eval"||id==="arguments"}function isKeyword(id){var keyword=false;switch(id.length){case 2:keyword=id==="if"||id==="in"||id==="do";break;case 3:keyword=id==="var"||id==="for"||id==="new"||id==="try";break;case 4:keyword=id==="this"||id==="else"||id==="case"||id==="void"||id==="with";break;case 5:keyword=id==="while"||id==="break"||id==="catch"||id==="throw";break;case 6:keyword=id==="return"||id==="typeof"||id==="delete"||id==="switch";break;case 7:keyword=id==="default"||id==="finally";break;case 8:keyword=id==="function"||id==="continue"||id==="debugger";break;case 10:keyword=id==="instanceof";break}if(keyword){return true}switch(id){case"const":return true;case"yield":case"let":return true}if(strict&&isStrictModeReservedWord(id)){return true}return isFutureReservedWord(id)}function nextChar(){return source[index++]}function skipComment(){var ch,blockComment,lineComment;blockComment=false;lineComment=false;while(index<length){ch=source[index];if(lineComment){ch=nextChar();if(isLineTerminator(ch)){lineComment=false;if(ch==="\r"&&source[index]==="\n"){++index}++lineNumber;lineStart=index}}else if(blockComment){if(isLineTerminator(ch)){if(ch==="\r"&&source[index+1]==="\n"){++index}++lineNumber;++index;lineStart=index;if(index>=length){throwError({},Messages.UnexpectedToken,"ILLEGAL")}}else{ch=nextChar();if(index>=length){throwError({},Messages.UnexpectedToken,"ILLEGAL")}if(ch==="*"){ch=source[index];if(ch==="/"){++index;blockComment=false}}}}else if(ch==="/"){ch=source[index+1];if(ch==="/"){index+=2;lineComment=true}else if(ch==="*"){index+=2;blockComment=true;if(index>=length){throwError({},Messages.UnexpectedToken,"ILLEGAL")}}else{break}}else if(isWhiteSpace(ch)){++index}else if(isLineTerminator(ch)){++index;if(ch==="\r"&&source[index]==="\n"){++index}++lineNumber;lineStart=index}else{break}}}function scanHexEscape(prefix){var i,len,ch,code=0;len=prefix==="u"?4:2;for(i=0;i<len;++i){if(index<length&&isHexDigit(source[index])){ch=nextChar();code=code*16+"0123456789abcdef".indexOf(ch.toLowerCase())}else{return""}}return String.fromCharCode(code)}function scanUnicodeCodePointEscape(){var ch,code,cu1,cu2;ch=source[index];code=0;if(ch==="}"){throwError({},Messages.UnexpectedToken,"ILLEGAL")}while(index<length){ch=nextChar();if(!isHexDigit(ch)){break}code=code*16+"0123456789abcdef".indexOf(ch.toLowerCase())}if(code>1114111||ch!=="}"){throwError({},Messages.UnexpectedToken,"ILLEGAL")}if(code<=65535){return String.fromCharCode(code)}cu1=(code-65536>>10)+55296;cu2=(code-65536&1023)+56320;return String.fromCharCode(cu1,cu2)}function scanIdentifier(){var ch,start,id,restore;ch=source[index];if(!isIdentifierStart(ch)){return}start=index;if(ch==="\\"){++index;if(source[index]!=="u"){return}++index;restore=index;ch=scanHexEscape("u");if(ch){if(ch==="\\"||!isIdentifierStart(ch)){return}id=ch}else{index=restore;id="u"}}else{id=nextChar()}while(index<length){ch=source[index];if(!isIdentifierPart(ch)){break}if(ch==="\\"){++index;if(source[index]!=="u"){return}++index;restore=index;ch=scanHexEscape("u");if(ch){if(ch==="\\"||!isIdentifierPart(ch)){return}id+=ch}else{index=restore;id+="u"}}else{id+=nextChar()}}if(id.length===1){return{type:Token.Identifier,value:id,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}if(isKeyword(id)){return{type:Token.Keyword,value:id,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}if(id==="null"){return{type:Token.NullLiteral,value:id,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}if(id==="true"||id==="false"){return{type:Token.BooleanLiteral,value:id,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}return{type:Token.Identifier,value:id,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}function scanPunctuator(){var start=index,ch1=source[index],ch2,ch3,ch4;if(ch1===";"||ch1==="{"||ch1==="}"){++index;return{type:Token.Punctuator,value:ch1,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}if(ch1===","||ch1==="("||ch1===")"){++index;return{type:Token.Punctuator,value:ch1,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}ch2=source[index+1];if(ch1==="."&&!isDecimalDigit(ch2)){return{type:Token.Punctuator,value:nextChar(),lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}ch3=source[index+2];ch4=source[index+3];if(ch1===">"&&ch2===">"&&ch3===">"){if(ch4==="="){index+=4;return{type:Token.Punctuator,value:">>>=",lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}}if(ch1==="="&&ch2==="="&&ch3==="="){index+=3;return{type:Token.Punctuator,value:"===",lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}if(ch1==="!"&&ch2==="="&&ch3==="="){index+=3;return{type:Token.Punctuator,value:"!==",lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}if(ch1===">"&&ch2===">"&&ch3===">"){index+=3;return{type:Token.Punctuator,value:">>>",lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}if(ch1==="<"&&ch2==="<"&&ch3==="="){index+=3;return{type:Token.Punctuator,value:"<<=",lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}if(ch1===">"&&ch2===">"&&ch3==="="){index+=3;return{type:Token.Punctuator,value:">>=",lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}if(ch2==="="){if("<>=!+-*%&|^/".indexOf(ch1)>=0){index+=2;return{type:Token.Punctuator,value:ch1+ch2,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}}if(ch1===ch2&&"+-<>&|".indexOf(ch1)>=0){if("+-<>&|".indexOf(ch2)>=0){index+=2;return{type:Token.Punctuator,value:ch1+ch2,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}}if(ch1==="="&&ch2===">"){index+=2;return{type:Token.Punctuator,value:"=>",lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}if("[]<>+-*%&|^!~?:=/".indexOf(ch1)>=0){return{type:Token.Punctuator,value:nextChar(),lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}}function scanNumericLiteral(){var number,start,ch,octal;ch=source[index];assert(isDecimalDigit(ch)||ch===".","Numeric literal must start with a decimal digit or a decimal point");start=index;number="";if(ch!=="."){number=nextChar();ch=source[index];if(number==="0"){if(ch==="x"||ch==="X"){number+=nextChar();while(index<length){ch=source[index];if(!isHexDigit(ch)){break}number+=nextChar()}if(number.length<=2){throwError({},Messages.UnexpectedToken,"ILLEGAL")}if(index<length){ch=source[index];if(isIdentifierStart(ch)){throwError({},Messages.UnexpectedToken,"ILLEGAL")}}return{type:Token.NumericLiteral,value:parseInt(number,16),lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}else if(ch==="b"||ch==="B"){nextChar();number="";while(index<length){ch=source[index];if(ch!=="0"&&ch!=="1"){break}number+=nextChar()}if(number.length===0){throwError({},Messages.UnexpectedToken,"ILLEGAL")}if(index<length){ch=source[index];if(isIdentifierStart(ch)||isDecimalDigit(ch)){throwError({},Messages.UnexpectedToken,"ILLEGAL")}}return{type:Token.NumericLiteral,value:parseInt(number,2),lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}else if(ch==="o"||ch==="O"||isOctalDigit(ch)){if(isOctalDigit(ch)){octal=true;number=nextChar()}else{octal=false;nextChar();number=""}while(index<length){ch=source[index];if(!isOctalDigit(ch)){break}number+=nextChar()}if(number.length===0){throwError({},Messages.UnexpectedToken,"ILLEGAL")}if(index<length){ch=source[index];if(isIdentifierStart(ch)||isDecimalDigit(ch)){throwError({},Messages.UnexpectedToken,"ILLEGAL")}}return{type:Token.NumericLiteral,value:parseInt(number,8),octal:octal,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}if(isDecimalDigit(ch)){throwError({},Messages.UnexpectedToken,"ILLEGAL")}}while(index<length){ch=source[index];if(!isDecimalDigit(ch)){break}number+=nextChar()}}if(ch==="."){number+=nextChar();while(index<length){ch=source[index];if(!isDecimalDigit(ch)){break}number+=nextChar()}}if(ch==="e"||ch==="E"){number+=nextChar();ch=source[index];if(ch==="+"||ch==="-"){number+=nextChar()}ch=source[index];if(isDecimalDigit(ch)){number+=nextChar();while(index<length){ch=source[index];if(!isDecimalDigit(ch)){break}number+=nextChar()}}else{ch="character "+ch;if(index>=length){ch="<end>"}throwError({},Messages.UnexpectedToken,"ILLEGAL")}}if(index<length){ch=source[index];if(isIdentifierStart(ch)){throwError({},Messages.UnexpectedToken,"ILLEGAL")}}return{type:Token.NumericLiteral,value:parseFloat(number),lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}function scanStringLiteral(){var str="",quote,start,ch,code,unescaped,restore,octal=false;quote=source[index];assert(quote==="'"||quote==='"',"String literal must starts with a quote");start=index;++index;while(index<length){ch=nextChar();if(ch===quote){quote="";break}else if(ch==="\\"){ch=nextChar();if(!isLineTerminator(ch)){switch(ch){case"n":str+="\n";break;case"r":str+="\r";break;case"t":str+="	";break;case"u":case"x":if(source[index]==="{"){++index;str+=scanUnicodeCodePointEscape()}else{restore=index;unescaped=scanHexEscape(ch);if(unescaped){str+=unescaped}else{index=restore;str+=ch}}break;case"b":str+="\b";break;case"f":str+="\f";break;case"v":str+="";break;default:if(isOctalDigit(ch)){code="01234567".indexOf(ch);if(code!==0){octal=true}if(index<length&&isOctalDigit(source[index])){octal=true;code=code*8+"01234567".indexOf(nextChar());if("0123".indexOf(ch)>=0&&index<length&&isOctalDigit(source[index])){code=code*8+"01234567".indexOf(nextChar())}}str+=String.fromCharCode(code)}else{str+=ch}break}}else{++lineNumber;if(ch==="\r"&&source[index]==="\n"){++index}}}else if(isLineTerminator(ch)){break}else{str+=ch}}if(quote!==""){throwError({},Messages.UnexpectedToken,"ILLEGAL")}return{type:Token.StringLiteral,value:str,octal:octal,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}function scanQuasi(){var cooked="",ch,start,terminated,tail,restore,unescaped,code,octal;terminated=false;tail=false;start=index;++index;while(index<length){ch=nextChar();if(ch==="`"){tail=true;terminated=true;break}else if(ch==="$"){if(source[index]==="{"){++index;terminated=true;break}cooked+=ch}else if(ch==="\\"){ch=nextChar();if(!isLineTerminator(ch)){switch(ch){case"n":cooked+="\n";break;case"r":cooked+="\r";break;case"t":cooked+="	";break;case"u":case"x":if(source[index]==="{"){++index;cooked+=scanUnicodeCodePointEscape()}else{restore=index;unescaped=scanHexEscape(ch);if(unescaped){cooked+=unescaped}else{index=restore;cooked+=ch}}break;case"b":cooked+="\b";break;case"f":cooked+="\f";break;case"v":cooked+="";break;default:if(isOctalDigit(ch)){code="01234567".indexOf(ch);if(code!==0){octal=true}if(index<length&&isOctalDigit(source[index])){octal=true;code=code*8+"01234567".indexOf(nextChar());if("0123".indexOf(ch)>=0&&index<length&&isOctalDigit(source[index])){code=code*8+"01234567".indexOf(nextChar())}}cooked+=String.fromCharCode(code)}else{cooked+=ch}break}}else{++lineNumber;if(ch==="\r"&&source[index]==="\n"){++index}}}else if(isLineTerminator(ch)){++lineNumber;if(ch==="\r"&&source[index]==="\n"){++index}}else{cooked+=ch}}if(!terminated){throwError({},Messages.UnexpectedToken,"ILLEGAL")}return{type:Token.Quasi,value:{cooked:cooked,raw:sliceSource(start+1,index-(tail?1:2))},tail:tail,octal:octal,lineNumber:lineNumber,lineStart:lineStart,range:[start,index]}}function scanQuasiElement(option){var startsWith;buffer=null;skipComment();startsWith=option.head?"`":"}";if(source[index]!==startsWith){throwError({},Messages.UnexpectedToken,"ILLEGAL")}return scanQuasi()}function scanRegExp(){var str="",ch,start,pattern,flags,value,classMarker=false,restore,terminated=false;buffer=null;skipComment();start=index;ch=source[index];assert(ch==="/","Regular expression literal must start with a slash");str=nextChar();while(index<length){ch=nextChar();str+=ch;if(classMarker){if(ch==="]"){classMarker=false}}else{if(ch==="\\"){ch=nextChar();if(isLineTerminator(ch)){throwError({},Messages.UnterminatedRegExp)}str+=ch}else if(ch==="/"){terminated=true;break}else if(ch==="["){classMarker=true}else if(isLineTerminator(ch)){throwError({},Messages.UnterminatedRegExp)}}}if(!terminated){throwError({},Messages.UnterminatedRegExp)}pattern=str.substr(1,str.length-2);flags="";while(index<length){ch=source[index];if(!isIdentifierPart(ch)){break}++index;if(ch==="\\"&&index<length){ch=source[index];if(ch==="u"){++index;restore=index;ch=scanHexEscape("u");if(ch){flags+=ch;str+="\\u";for(;restore<index;++restore){str+=source[restore]}}else{index=restore;flags+="u";str+="\\u"}}else{str+="\\"}}else{flags+=ch;str+=ch}}try{value=new RegExp(pattern,flags)}catch(e){throwError({},Messages.InvalidRegExp)}return{literal:str,value:value,range:[start,index]}}function isIdentifierName(token){return token.type===Token.Identifier||token.type===Token.Keyword||token.type===Token.BooleanLiteral||token.type===Token.NullLiteral}function advance(){var ch,token;skipComment();if(index>=length){return{type:Token.EOF,lineNumber:lineNumber,lineStart:lineStart,range:[index,index]}}token=scanPunctuator();if(typeof token!=="undefined"){return token}ch=source[index];if(ch==="'"||ch==='"'){return scanStringLiteral()}if(ch==="."||isDecimalDigit(ch)){return scanNumericLiteral()}if(ch==="`"){return scanQuasi()}token=scanIdentifier();if(typeof token!=="undefined"){return token}throwError({},Messages.UnexpectedToken,"ILLEGAL")}function lex(){var token;if(buffer){index=buffer.range[1];lineNumber=buffer.lineNumber;lineStart=buffer.lineStart;token=buffer;buffer=null;return token}buffer=null;return advance()}function lookahead(){var pos,line,start;if(buffer!==null){return buffer}pos=index;line=lineNumber;start=lineStart;buffer=advance();index=pos;lineNumber=line;lineStart=start;return buffer}function lookahead2(){var adv,pos,line,start,result;adv=typeof extra.advance==="function"?extra.advance:advance;pos=index;line=lineNumber;start=lineStart;if(buffer===null){buffer=adv()}index=buffer.range[1];lineNumber=buffer.lineNumber;lineStart=buffer.lineStart;result=adv();index=pos;lineNumber=line;lineStart=start;return result}function peekLineTerminator(){var pos,line,start,found;pos=index;line=lineNumber;start=lineStart;skipComment();found=lineNumber!==line;index=pos;lineNumber=line;lineStart=start;return found}function throwError(token,messageFormat){var error,args=Array.prototype.slice.call(arguments,2),msg=messageFormat.replace(/%(\d)/g,function(whole,index){return args[index]||""});if(typeof token.lineNumber==="number"){error=new Error("Line "+token.lineNumber+": "+msg);error.index=token.range[0];error.lineNumber=token.lineNumber;error.column=token.range[0]-lineStart+1}else{error=new Error("Line "+lineNumber+": "+msg);error.index=index;error.lineNumber=lineNumber;error.column=index-lineStart+1}throw error}function throwErrorTolerant(){try{throwError.apply(null,arguments)}catch(e){if(extra.errors){extra.errors.push(e)}else{throw e}}}function throwUnexpected(token){if(token.type===Token.EOF){throwError(token,Messages.UnexpectedEOS)}if(token.type===Token.NumericLiteral){throwError(token,Messages.UnexpectedNumber)}if(token.type===Token.StringLiteral){throwError(token,Messages.UnexpectedString)}if(token.type===Token.Identifier){throwError(token,Messages.UnexpectedIdentifier)}if(token.type===Token.Keyword){if(isFutureReservedWord(token.value)){throwError(token,Messages.UnexpectedReserved)}else if(strict&&isStrictModeReservedWord(token.value)){throwError(token,Messages.StrictReservedWord)}throwError(token,Messages.UnexpectedToken,token.value)}if(token.type===Token.Quasi){throwError(token,Messages.UnexpectedQuasi,token.value.raw)}throwError(token,Messages.UnexpectedToken,token.value)}function expect(value){var token=lex();if(token.type!==Token.Punctuator||token.value!==value){throwUnexpected(token)}}function expectKeyword(keyword){var token=lex();if(token.type!==Token.Keyword||token.value!==keyword){throwUnexpected(token)}}function match(value){var token=lookahead();return token.type===Token.Punctuator&&token.value===value}function matchKeyword(keyword){var token=lookahead();return token.type===Token.Keyword&&token.value===keyword}function matchContextualKeyword(keyword){var token=lookahead();return token.type===Token.Identifier&&token.value===keyword}function matchAssign(){var token=lookahead(),op=token.value;if(token.type!==Token.Punctuator){return false}return op==="="||op==="*="||op==="/="||op==="%="||op==="+="||op==="-="||op==="<<="||op===">>="||op===">>>="||op==="&="||op==="^="||op==="|="}function consumeSemicolon(){var token,line;if(source[index]===";"){lex();return}line=lineNumber;skipComment();if(lineNumber!==line){return}if(match(";")){lex();return}token=lookahead();if(token.type!==Token.EOF&&!match("}")){throwUnexpected(token)}return}function isLeftHandSide(expr){return expr.type===Syntax.Identifier||expr.type===Syntax.MemberExpression}function isAssignableLeftHandSide(expr){return isLeftHandSide(expr)||expr.type===Syntax.ObjectPattern||expr.type===Syntax.ArrayPattern}function parseArrayInitialiser(){var elements=[];expect("[");while(!match("]")){if(match(",")){lex();elements.push(null)}else{elements.push(parseAssignmentExpression());if(!match("]")){expect(",")}}}expect("]");return{type:Syntax.ArrayExpression,elements:elements}}function parsePropertyFunction(param,options){var previousStrict,previousYieldAllowed,body;previousStrict=strict;previousYieldAllowed=yieldAllowed;yieldAllowed=options.generator;body=parseConciseBody();if(options.name&&strict&&isRestrictedWord(param[0].name)){throwError(options.name,Messages.StrictParamName)}if(yieldAllowed&&!yieldFound){throwError({},Messages.NoYieldInGenerator)}strict=previousStrict;yieldAllowed=previousYieldAllowed;return{type:Syntax.FunctionExpression,id:null,params:param,defaults:[],body:body,rest:null,generator:options.generator,expression:body.type!==Syntax.BlockStatement}}function parsePropertyMethodFunction(options){var token,previousStrict,param,params,paramSet,method;previousStrict=strict;strict=true;params=[];expect("(");if(!match(")")){paramSet={};while(index<length){token=lookahead();param=parseVariableIdentifier();if(isRestrictedWord(token.value)){throwError(token,Messages.StrictParamName)}if(Object.prototype.hasOwnProperty.call(paramSet,token.value)){throwError(token,Messages.StrictParamDupe)}params.push(param);paramSet[param.name]=true;if(match(")")){break}expect(",")}}expect(")");method=parsePropertyFunction(params,{generator:options.generator});strict=previousStrict;return method}function parseObjectPropertyKey(){var token=lex();if(token.type===Token.StringLiteral||token.type===Token.NumericLiteral){if(strict&&token.octal){throwError(token,Messages.StrictOctalLiteral)}return createLiteral(token)}return{type:Syntax.Identifier,name:token.value}}function parseObjectProperty(){var token,key,id,param;token=lookahead();if(token.type===Token.Identifier){id=parseObjectPropertyKey();if(token.value==="get"&&!(match(":")||match("("))){key=parseObjectPropertyKey();expect("(");expect(")");return{type:Syntax.Property,key:key,value:parsePropertyFunction([],{generator:false}),kind:"get"}}else if(token.value==="set"&&!(match(":")||match("("))){key=parseObjectPropertyKey();expect("(");token=lookahead();param=[parseVariableIdentifier()];expect(")");return{type:Syntax.Property,key:key,value:parsePropertyFunction(param,{generator:false,name:token}),kind:"set"}}else{if(match(":")){lex();return{type:Syntax.Property,key:id,value:parseAssignmentExpression(),kind:"init"}}else if(match("(")){return{type:Syntax.Property,key:id,value:parsePropertyMethodFunction({generator:false}),kind:"init",method:true}}else{return{type:Syntax.Property,key:id,value:id,kind:"init",shorthand:true}}}}else if(token.type===Token.EOF||token.type===Token.Punctuator){if(!match("*")){throwUnexpected(token)}lex();id=parseObjectPropertyKey();if(!match("(")){throwUnexpected(lex())}return{type:Syntax.Property,key:id,value:parsePropertyMethodFunction({generator:true}),kind:"init",method:true}}else{key=parseObjectPropertyKey();if(match(":")){lex();return{type:Syntax.Property,key:key,value:parseAssignmentExpression(),kind:"init"}}else if(match("(")){return{type:Syntax.Property,key:key,value:parsePropertyMethodFunction({generator:false}),kind:"init",method:true}}else{return{type:Syntax.Property,key:key,value:key,kind:"init",shorthand:true}}}}function parseObjectInitialiser(){var properties=[],property,name,kind,map={},toString=String;expect("{");while(!match("}")){property=parseObjectProperty();if(property.key.type===Syntax.Identifier){name=property.key.name}else{name=toString(property.key.value)}kind=property.kind==="init"?PropertyKind.Data:property.kind==="get"?PropertyKind.Get:PropertyKind.Set;if(Object.prototype.hasOwnProperty.call(map,name)){if(map[name]===PropertyKind.Data){if(strict&&kind===PropertyKind.Data){throwErrorTolerant({},Messages.StrictDuplicateProperty)}else if(kind!==PropertyKind.Data){throwError({},Messages.AccessorDataProperty)}}else{if(kind===PropertyKind.Data){throwError({},Messages.AccessorDataProperty)}else if(map[name]&kind){throwError({},Messages.AccessorGetSet)}}map[name]|=kind}else{map[name]=kind}properties.push(property);if(!match("}")){expect(",")}}expect("}");return{type:Syntax.ObjectExpression,properties:properties}}function parseQuasiElement(option){var token=scanQuasiElement(option);if(strict&&token.octal){throwError(token,Messages.StrictOctalLiteral)}return{type:Syntax.QuasiElement,value:{raw:token.value.raw,cooked:token.value.cooked},tail:token.tail}}function parseQuasiLiteral(){var quasi,quasis,expressions;quasi=parseQuasiElement({head:true});quasis=[quasi];expressions=[];while(!quasi.tail){expressions.push(parseExpression());quasi=parseQuasiElement({head:false});quasis.push(quasi)}return{type:Syntax.QuasiLiteral,quasis:quasis,expressions:expressions}}function parsePrimaryExpression(){var expr,token=lookahead(),type=token.type;if(type===Token.Identifier){return{type:Syntax.Identifier,name:lex().value}}if(type===Token.StringLiteral||type===Token.NumericLiteral){if(strict&&token.octal){throwErrorTolerant(token,Messages.StrictOctalLiteral)}return createLiteral(lex())}if(type===Token.Keyword){if(matchKeyword("this")){lex();return{type:Syntax.ThisExpression}}if(matchKeyword("function")){return parseFunctionExpression()}if(matchKeyword("class")){return parseClassExpression()}if(matchKeyword("super")){lex();return{type:Syntax.Identifier,name:"super"}}}if(type===Token.BooleanLiteral){lex();token.value=token.value==="true";return createLiteral(token)}if(type===Token.NullLiteral){lex();token.value=null;return createLiteral(token)}if(match("[")){return parseArrayInitialiser()}if(match("{")){return parseObjectInitialiser()}if(match("(")){lex();state.lastParenthesized=expr=parseExpression();state.parenthesizedCount+=1;expect(")");return expr}if(match("/")||match("/=")){return createLiteral(scanRegExp())}if(type===Token.Quasi){return parseQuasiLiteral()}return throwUnexpected(lex())}function parseArguments(){var args=[];expect("(");if(!match(")")){while(index<length){args.push(parseAssignmentExpression());if(match(")")){break}expect(",")}}expect(")");return args}function parseNonComputedProperty(){var token=lex();if(!isIdentifierName(token)){throwUnexpected(token)}return{type:Syntax.Identifier,name:token.value}}function parseNonComputedMember(object){return{type:Syntax.MemberExpression,computed:false,object:object,property:parseNonComputedProperty()}}function parseComputedMember(object){var property,expr;expect("[");property=parseExpression();expr={type:Syntax.MemberExpression,computed:true,object:object,property:property};expect("]");return expr}function parseTaggedQuasi(tag){return{type:Syntax.TaggedQuasiExpression,tag:tag,quasi:parseQuasiLiteral()}}function parseCallMember(object){return{type:Syntax.CallExpression,callee:object,arguments:parseArguments()}}function parseNewExpression(){var expr;expectKeyword("new");expr={type:Syntax.NewExpression,callee:parseLeftHandSideExpression(),arguments:[]};if(match("(")){expr["arguments"]=parseArguments()}return expr}function parseLeftHandSideExpressionAllowCall(){var useNew,expr;useNew=matchKeyword("new");expr=useNew?parseNewExpression():parsePrimaryExpression();while(index<length){if(match(".")){lex();expr=parseNonComputedMember(expr)}else if(match("[")){expr=parseComputedMember(expr)}else if(match("(")){expr=parseCallMember(expr)}else if(lookahead().type===Token.Quasi){expr=parseTaggedQuasi(expr)}else{break}}return expr}function parseLeftHandSideExpression(){var useNew,expr;useNew=matchKeyword("new");expr=useNew?parseNewExpression():parsePrimaryExpression();while(index<length){if(match(".")){lex();expr=parseNonComputedMember(expr)}else if(match("[")){expr=parseComputedMember(expr)}else if(lookahead().type===Token.Quasi){expr=parseTaggedQuasi(expr)}else{break}}return expr}function parsePostfixExpression(){var expr=parseLeftHandSideExpressionAllowCall();if((match("++")||match("--"))&&!peekLineTerminator()){if(strict&&expr.type===Syntax.Identifier&&isRestrictedWord(expr.name)){throwError({},Messages.StrictLHSPostfix)}if(!isLeftHandSide(expr)){throwError({},Messages.InvalidLHSInAssignment)}expr={type:Syntax.UpdateExpression,operator:lex().value,argument:expr,prefix:false}}return expr}function parseUnaryExpression(){var token,expr;if(match("++")||match("--")){token=lex();expr=parseUnaryExpression();if(strict&&expr.type===Syntax.Identifier&&isRestrictedWord(expr.name)){throwError({},Messages.StrictLHSPrefix)}if(!isLeftHandSide(expr)){throwError({},Messages.InvalidLHSInAssignment)}expr={type:Syntax.UpdateExpression,operator:token.value,argument:expr,prefix:true};return expr}if(match("+")||match("-")||match("~")||match("!")){expr={type:Syntax.UnaryExpression,operator:lex().value,argument:parseUnaryExpression()};return expr}if(matchKeyword("delete")||matchKeyword("void")||matchKeyword("typeof")){expr={type:Syntax.UnaryExpression,operator:lex().value,argument:parseUnaryExpression()};if(strict&&expr.operator==="delete"&&expr.argument.type===Syntax.Identifier){throwErrorTolerant({},Messages.StrictDelete)}return expr}return parsePostfixExpression()}function parseMultiplicativeExpression(){var expr=parseUnaryExpression();while(match("*")||match("/")||match("%")){expr={type:Syntax.BinaryExpression,operator:lex().value,left:expr,right:parseUnaryExpression()}}return expr}function parseAdditiveExpression(){var expr=parseMultiplicativeExpression();while(match("+")||match("-")){expr={type:Syntax.BinaryExpression,operator:lex().value,left:expr,right:parseMultiplicativeExpression()}}return expr}function parseShiftExpression(){var expr=parseAdditiveExpression();while(match("<<")||match(">>")||match(">>>")){expr={type:Syntax.BinaryExpression,operator:lex().value,left:expr,right:parseAdditiveExpression()}}return expr}function parseRelationalExpression(){var expr,previousAllowIn;previousAllowIn=state.allowIn;state.allowIn=true;expr=parseShiftExpression();while(match("<")||match(">")||match("<=")||match(">=")||previousAllowIn&&matchKeyword("in")||matchKeyword("instanceof")){expr={type:Syntax.BinaryExpression,operator:lex().value,left:expr,right:parseShiftExpression()}}state.allowIn=previousAllowIn;return expr}function parseEqualityExpression(){var expr=parseRelationalExpression();while(!peekLineTerminator()&&(matchContextualKeyword("is")||matchContextualKeyword("isnt"))||match("==")||match("!=")||match("===")||match("!==")){expr={type:Syntax.BinaryExpression,operator:lex().value,left:expr,right:parseRelationalExpression()}}return expr}function parseBitwiseANDExpression(){var expr=parseEqualityExpression();while(match("&")){lex();expr={type:Syntax.BinaryExpression,operator:"&",left:expr,right:parseEqualityExpression()}}return expr}function parseBitwiseXORExpression(){var expr=parseBitwiseANDExpression();while(match("^")){lex();expr={type:Syntax.BinaryExpression,operator:"^",left:expr,right:parseBitwiseANDExpression()}}return expr}function parseBitwiseORExpression(){var expr=parseBitwiseXORExpression();while(match("|")){lex();expr={type:Syntax.BinaryExpression,operator:"|",left:expr,right:parseBitwiseXORExpression()}}return expr}function parseLogicalANDExpression(){var expr=parseBitwiseORExpression();while(match("&&")){lex();expr={type:Syntax.LogicalExpression,operator:"&&",left:expr,right:parseBitwiseORExpression()}}return expr}function parseLogicalORExpression(){var expr=parseLogicalANDExpression();while(match("||")){lex();expr={type:Syntax.LogicalExpression,operator:"||",left:expr,right:parseLogicalANDExpression()}}return expr}function parseConditionalExpression(){var expr,previousAllowIn,consequent;expr=parseLogicalORExpression();if(match("?")){lex();previousAllowIn=state.allowIn;state.allowIn=true;consequent=parseAssignmentExpression();state.allowIn=previousAllowIn;expect(":");expr={type:Syntax.ConditionalExpression,test:expr,consequent:consequent,alternate:parseAssignmentExpression()}}return expr}function reinterpretAsAssignmentBindingPattern(expr){var i,len,property,element;if(expr.type===Syntax.ObjectExpression){expr.type=Syntax.ObjectPattern;for(i=0,len=expr.properties.length;i<len;i+=1){property=expr.properties[i];if(property.kind!=="init"){throwError({},Messages.InvalidLHSInAssignment)}reinterpretAsAssignmentBindingPattern(property.value)}}else if(expr.type===Syntax.ArrayExpression){expr.type=Syntax.ArrayPattern;for(i=0,len=expr.elements.length;i<len;i+=1){element=expr.elements[i];if(element){reinterpretAsAssignmentBindingPattern(element)}}}else if(expr.type===Syntax.Identifier){if(isRestrictedWord(expr.name)){throwError({},Messages.InvalidLHSInAssignment)}}else{if(expr.type!==Syntax.MemberExpression&&expr.type!==Syntax.CallExpression&&expr.type!==Syntax.NewExpression){throwError({},Messages.InvalidLHSInAssignment)}}}function reinterpretAsCoverFormalsList(expr){var i,len,param,paramSet;assert(expr.type===Syntax.SequenceExpression);paramSet={};for(i=0,len=expr.expressions.length;i<len;i+=1){param=expr.expressions[i];if(param.type!==Syntax.Identifier){return null}if(isRestrictedWord(param.name)){throwError({},Messages.StrictParamName)}if(Object.prototype.hasOwnProperty.call(paramSet,param.name)){throwError({},Messages.StrictParamDupe)}paramSet[param.name]=true}return expr.expressions}function parseArrowFunctionExpression(param){var previousStrict,previousYieldAllowed,body;expect("=>");previousStrict=strict;previousYieldAllowed=yieldAllowed;strict=true;yieldAllowed=false;body=parseConciseBody();strict=previousStrict;yieldAllowed=previousYieldAllowed;return{type:Syntax.ArrowFunctionExpression,id:null,params:param,defaults:[],body:body,rest:null,generator:false,expression:body.type!==Syntax.BlockStatement}}function parseAssignmentExpression(){var expr,token,oldParenthesizedCount,coverFormalsList;if(matchKeyword("yield")){return parseYieldExpression()}oldParenthesizedCount=state.parenthesizedCount;if(match("(")){token=lookahead2();if(token.type===Token.Punctuator&&token.value===")"){lex();lex();if(!match("=>")){throwUnexpected(lex())}return parseArrowFunctionExpression([])}}expr=parseConditionalExpression();if(match("=>")){if(expr.type===Syntax.Identifier){if(state.parenthesizedCount===oldParenthesizedCount||state.parenthesizedCount===oldParenthesizedCount+1){if(isRestrictedWord(expr.name)){throwError({},Messages.StrictParamName)}return parseArrowFunctionExpression([expr])}}else if(expr.type===Syntax.SequenceExpression){if(state.parenthesizedCount===oldParenthesizedCount+1){coverFormalsList=reinterpretAsCoverFormalsList(expr);if(coverFormalsList){return parseArrowFunctionExpression(coverFormalsList)}}}}if(matchAssign()){if(strict&&expr.type===Syntax.Identifier&&isRestrictedWord(expr.name)){throwError({},Messages.StrictLHSAssignment)}if(match("=")&&(expr.type===Syntax.ObjectExpression||expr.type===Syntax.ArrayExpression)){reinterpretAsAssignmentBindingPattern(expr)}else if(!isLeftHandSide(expr)){throwError({},Messages.InvalidLHSInAssignment)}expr={type:Syntax.AssignmentExpression,operator:lex().value,left:expr,right:parseAssignmentExpression()}}return expr}function parseExpression(){var expr=parseAssignmentExpression();if(match(",")){expr={type:Syntax.SequenceExpression,expressions:[expr]};while(index<length){if(!match(",")){break}lex();expr.expressions.push(parseAssignmentExpression())}}return expr}function parseStatementList(){var list=[],statement;while(index<length){if(match("}")){break}statement=parseSourceElement();if(typeof statement==="undefined"){break}list.push(statement)}return list}function parseBlock(){var block;expect("{");block=parseStatementList();expect("}");return{type:Syntax.BlockStatement,body:block}}function parseVariableIdentifier(){var token=lex();if(token.type!==Token.Identifier){throwUnexpected(token)}return{type:Syntax.Identifier,name:token.value}}function parseVariableDeclaration(kind){var id=parseVariableIdentifier(),init=null;if(strict&&isRestrictedWord(id.name)){throwErrorTolerant({},Messages.StrictVarName)}if(kind==="const"){expect("=");init=parseAssignmentExpression()}else if(match("=")){lex();init=parseAssignmentExpression()}return{type:Syntax.VariableDeclarator,id:id,init:init}}function parseVariableDeclarationList(kind){var list=[];while(index<length){list.push(parseVariableDeclaration(kind));if(!match(",")){break}lex()}return list}function parseVariableStatement(){var declarations;expectKeyword("var");declarations=parseVariableDeclarationList();consumeSemicolon();return{type:Syntax.VariableDeclaration,declarations:declarations,kind:"var"}}function parseConstLetDeclaration(kind){var declarations;expectKeyword(kind);declarations=parseVariableDeclarationList(kind);consumeSemicolon();return{type:Syntax.VariableDeclaration,declarations:declarations,kind:kind}}function parsePath(){var result,id;result={type:Syntax.Path,body:[]};while(true){id=parseVariableIdentifier();result.body.push(id);if(!match(".")){break}lex()}return result}function parseGlob(){expect("*");return{type:Syntax.Glob}}function parseModuleDeclaration(){var id,token,declaration;lex();id=parseVariableIdentifier();if(match("{")){return{type:Syntax.ModuleDeclaration,id:id,body:parseModuleBlock()}}expect("=");token=lookahead();if(token.type===Token.StringLiteral){declaration={type:Syntax.ModuleDeclaration,id:id,from:parsePrimaryExpression()}}else{declaration={type:Syntax.ModuleDeclaration,id:id,from:parsePath()}}consumeSemicolon();return declaration}function parseExportSpecifierSetProperty(){var specifier;specifier={type:Syntax.ExportSpecifier,id:parseVariableIdentifier(),from:null};if(match(":")){lex();specifier.from=parsePath()}return specifier}function parseExportSpecifier(){var specifier,specifiers;if(match("{")){lex();specifiers=[];do{specifiers.push(parseExportSpecifierSetProperty())}while(match(",")&&lex());expect("}");return{type:Syntax.ExportSpecifierSet,specifiers:specifiers}}if(match("*")){specifier={type:Syntax.ExportSpecifier,id:parseGlob(),from:null};if(matchContextualKeyword("from")){lex();specifier.from=parsePath()}}else{specifier={type:Syntax.ExportSpecifier,id:parseVariableIdentifier(),from:null}}return specifier}function parseExportDeclaration(){var token,specifiers;expectKeyword("export");token=lookahead();if(token.type===Token.Keyword||token.type===Token.Identifier&&token.value==="module"){switch(token.value){case"function":return{type:Syntax.ExportDeclaration,declaration:parseFunctionDeclaration()};case"module":return{type:Syntax.ExportDeclaration,declaration:parseModuleDeclaration()};case"let":case"const":return{type:Syntax.ExportDeclaration,declaration:parseConstLetDeclaration(token.value)};case"var":return{type:Syntax.ExportDeclaration,declaration:parseStatement()}}throwUnexpected(lex())}specifiers=[parseExportSpecifier()];if(match(",")){while(index<length){if(!match(",")){break}lex();specifiers.push(parseExportSpecifier())}}consumeSemicolon();return{type:Syntax.ExportDeclaration,specifiers:specifiers}}function parseImportDeclaration(){var specifiers,from;expectKeyword("import");if(match("*")){specifiers=[parseGlob()]}else if(match("{")){lex();specifiers=[];do{specifiers.push(parseImportSpecifier())}while(match(",")&&lex());expect("}")}else{specifiers=[parseVariableIdentifier()]}if(!matchContextualKeyword("from")){throwError({},Messages.NoFromAfterImport)}lex();if(lookahead().type===Token.StringLiteral){from=parsePrimaryExpression()}else{from=parsePath()}consumeSemicolon();return{type:Syntax.ImportDeclaration,specifiers:specifiers,from:from}}function parseImportSpecifier(){var specifier;specifier={type:Syntax.ImportSpecifier,id:parseVariableIdentifier(),from:null};if(match(":")){lex();specifier.from=parsePath()}return specifier}function parseEmptyStatement(){expect(";");return{type:Syntax.EmptyStatement}}function parseExpressionStatement(){var expr=parseExpression();consumeSemicolon();return{type:Syntax.ExpressionStatement,expression:expr}}function parseIfStatement(){var test,consequent,alternate;expectKeyword("if");expect("(");test=parseExpression();expect(")");consequent=parseStatement();if(matchKeyword("else")){lex();alternate=parseStatement()}else{alternate=null}return{type:Syntax.IfStatement,test:test,consequent:consequent,alternate:alternate}}function parseDoWhileStatement(){var body,test,oldInIteration;expectKeyword("do");oldInIteration=state.inIteration;state.inIteration=true;body=parseStatement();state.inIteration=oldInIteration;expectKeyword("while");expect("(");test=parseExpression();expect(")");if(match(";")){lex()}return{type:Syntax.DoWhileStatement,body:body,test:test}}function parseWhileStatement(){var test,body,oldInIteration;expectKeyword("while");expect("(");test=parseExpression();expect(")");oldInIteration=state.inIteration;state.inIteration=true;body=parseStatement();state.inIteration=oldInIteration;return{type:Syntax.WhileStatement,test:test,body:body}}function parseForVariableDeclaration(){var token=lex();return{type:Syntax.VariableDeclaration,declarations:parseVariableDeclarationList(),kind:token.value}}function parseForStatement(){var init,test,update,left,right,body,operator,oldInIteration;init=test=update=null;expectKeyword("for");expect("(");if(match(";")){lex()}else{if(matchKeyword("var")||matchKeyword("let")||matchKeyword("const")){state.allowIn=false;init=parseForVariableDeclaration();state.allowIn=true;if(init.declarations.length===1){if(matchKeyword("in")||matchContextualKeyword("of")){operator=lookahead();if(!((operator.value==="in"||init.kind!=="var")&&init.declarations[0].init)){lex();left=init;right=parseExpression();init=null}}}}else{state.allowIn=false;init=parseExpression();state.allowIn=true;if(matchContextualKeyword("of")){operator=lex();left=init;right=parseExpression();init=null}else if(matchKeyword("in")){if(!isAssignableLeftHandSide(init)){throwError({},Messages.InvalidLHSInForIn)}operator=lex();left=init;right=parseExpression();init=null}}if(typeof left==="undefined"){expect(";")}}if(typeof left==="undefined"){if(!match(";")){test=parseExpression()}expect(";");if(!match(")")){update=parseExpression()}}expect(")");oldInIteration=state.inIteration;state.inIteration=true;body=parseStatement();state.inIteration=oldInIteration;if(typeof left==="undefined"){return{type:Syntax.ForStatement,init:init,test:test,update:update,body:body}}if(operator.value==="in"){return{type:Syntax.ForInStatement,left:left,right:right,body:body,each:false}}else{return{type:Syntax.ForOfStatement,left:left,right:right,body:body}}}function parseContinueStatement(){var token,label=null;expectKeyword("continue");if(source[index]===";"){lex();if(!state.inIteration){throwError({},Messages.IllegalContinue)}return{type:Syntax.ContinueStatement,label:null}}if(peekLineTerminator()){if(!state.inIteration){throwError({},Messages.IllegalContinue)}return{type:Syntax.ContinueStatement,label:null}}token=lookahead();if(token.type===Token.Identifier){label=parseVariableIdentifier();if(!Object.prototype.hasOwnProperty.call(state.labelSet,label.name)){throwError({},Messages.UnknownLabel,label.name)}}consumeSemicolon();if(label===null&&!state.inIteration){throwError({},Messages.IllegalContinue)}return{type:Syntax.ContinueStatement,label:label}}function parseBreakStatement(){var token,label=null;expectKeyword("break");if(source[index]===";"){lex();if(!(state.inIteration||state.inSwitch)){throwError({},Messages.IllegalBreak)}return{type:Syntax.BreakStatement,label:null}}if(peekLineTerminator()){if(!(state.inIteration||state.inSwitch)){throwError({},Messages.IllegalBreak)}return{type:Syntax.BreakStatement,label:null}}token=lookahead();if(token.type===Token.Identifier){label=parseVariableIdentifier();if(!Object.prototype.hasOwnProperty.call(state.labelSet,label.name)){throwError({},Messages.UnknownLabel,label.name)}}consumeSemicolon();if(label===null&&!(state.inIteration||state.inSwitch)){throwError({},Messages.IllegalBreak)}return{type:Syntax.BreakStatement,label:label}}function parseReturnStatement(){var token,argument=null;expectKeyword("return");if(!state.inFunctionBody){throwErrorTolerant({},Messages.IllegalReturn)}if(source[index]===" "){if(isIdentifierStart(source[index+1])){argument=parseExpression();consumeSemicolon();return{type:Syntax.ReturnStatement,argument:argument}}}if(peekLineTerminator()){return{type:Syntax.ReturnStatement,argument:null}}if(!match(";")){token=lookahead();if(!match("}")&&token.type!==Token.EOF){argument=parseExpression()}}consumeSemicolon();return{type:Syntax.ReturnStatement,argument:argument}}function parseWithStatement(){var object,body;if(strict){throwErrorTolerant({},Messages.StrictModeWith)}expectKeyword("with");expect("(");object=parseExpression();expect(")");body=parseStatement();return{type:Syntax.WithStatement,object:object,body:body}}function parseSwitchCase(){var test,consequent=[],statement;if(matchKeyword("default")){lex();test=null}else{expectKeyword("case");test=parseExpression()}expect(":");while(index<length){if(match("}")||matchKeyword("default")||matchKeyword("case")){break}statement=parseSourceElement();if(typeof statement==="undefined"){break}consequent.push(statement)}return{type:Syntax.SwitchCase,test:test,consequent:consequent}}function parseSwitchStatement(){var discriminant,cases,clause,oldInSwitch,defaultFound;expectKeyword("switch");expect("(");discriminant=parseExpression();expect(")");expect("{");if(match("}")){lex();return{type:Syntax.SwitchStatement,discriminant:discriminant}}cases=[];oldInSwitch=state.inSwitch;state.inSwitch=true;defaultFound=false;while(index<length){if(match("}")){break}clause=parseSwitchCase();if(clause.test===null){if(defaultFound){throwError({},Messages.MultipleDefaultsInSwitch)}defaultFound=true}cases.push(clause)}state.inSwitch=oldInSwitch;expect("}");return{type:Syntax.SwitchStatement,discriminant:discriminant,cases:cases}}function parseThrowStatement(){var argument;expectKeyword("throw");if(peekLineTerminator()){throwError({},Messages.NewlineAfterThrow)}argument=parseExpression();consumeSemicolon();return{type:Syntax.ThrowStatement,argument:argument}}function parseCatchClause(){var param;expectKeyword("catch");expect("(");if(!match(")")){param=parseExpression();if(strict&&param.type===Syntax.Identifier&&isRestrictedWord(param.name)){throwErrorTolerant({},Messages.StrictCatchVariable)}}expect(")");return{type:Syntax.CatchClause,param:param,guard:null,body:parseBlock()}}function parseTryStatement(){var block,handlers=[],finalizer=null;expectKeyword("try");block=parseBlock();if(matchKeyword("catch")){handlers.push(parseCatchClause())}if(matchKeyword("finally")){lex();finalizer=parseBlock()}if(handlers.length===0&&!finalizer){throwError({},Messages.NoCatchOrFinally)}return{type:Syntax.TryStatement,block:block,handlers:handlers,finalizer:finalizer}}function parseDebuggerStatement(){expectKeyword("debugger");consumeSemicolon();return{type:Syntax.DebuggerStatement}}function parseStatement(){var token=lookahead(),expr,labeledBody;if(token.type===Token.EOF){throwUnexpected(token)}if(token.type===Token.Punctuator){switch(token.value){case";":return parseEmptyStatement();case"{":return parseBlock();case"(":return parseExpressionStatement();default:break}}if(token.type===Token.Keyword){switch(token.value){case"break":return parseBreakStatement();case"continue":return parseContinueStatement();case"debugger":return parseDebuggerStatement();case"do":return parseDoWhileStatement();case"for":return parseForStatement();case"function":return parseFunctionDeclaration();case"class":return parseClassDeclaration();case"if":return parseIfStatement();case"return":return parseReturnStatement();case"switch":return parseSwitchStatement();case"throw":return parseThrowStatement();case"try":return parseTryStatement();case"var":return parseVariableStatement();case"while":return parseWhileStatement();case"with":return parseWithStatement();default:break}}expr=parseExpression();if(expr.type===Syntax.Identifier&&match(":")){lex();if(Object.prototype.hasOwnProperty.call(state.labelSet,expr.name)){throwError({},Messages.Redeclaration,"Label",expr.name)}state.labelSet[expr.name]=true;labeledBody=parseStatement();delete state.labelSet[expr.name];return{type:Syntax.LabeledStatement,label:expr,body:labeledBody}}consumeSemicolon();return{type:Syntax.ExpressionStatement,expression:expr}}function parseConciseBody(){if(match("{")){return parseFunctionSourceElements()}else{return parseAssignmentExpression()}}function parseFunctionSourceElements(){var sourceElement,sourceElements=[],token,directive,firstRestricted,oldLabelSet,oldInIteration,oldInSwitch,oldInFunctionBody,oldParenthesizedCount;expect("{");while(index<length){token=lookahead();if(token.type!==Token.StringLiteral){break}sourceElement=parseSourceElement();sourceElements.push(sourceElement);if(sourceElement.expression.type!==Syntax.Literal){break}directive=sliceSource(token.range[0]+1,token.range[1]-1);if(directive==="use strict"){strict=true;if(firstRestricted){throwError(firstRestricted,Messages.StrictOctalLiteral)}}else{if(!firstRestricted&&token.octal){firstRestricted=token}}}oldLabelSet=state.labelSet;oldInIteration=state.inIteration;oldInSwitch=state.inSwitch;oldInFunctionBody=state.inFunctionBody;oldParenthesizedCount=state.parenthesizedCount;state.labelSet={};state.inIteration=false;state.inSwitch=false;state.inFunctionBody=true;state.parenthesizedCount=0;while(index<length){if(match("}")){break}sourceElement=parseSourceElement();if(typeof sourceElement==="undefined"){break}sourceElements.push(sourceElement)}expect("}");state.labelSet=oldLabelSet;state.inIteration=oldInIteration;state.inSwitch=oldInSwitch;state.inFunctionBody=oldInFunctionBody;state.parenthesizedCount=oldParenthesizedCount;return{type:Syntax.BlockStatement,body:sourceElements}}function parseFunctionDeclaration(){var id,param,params=[],body,token,firstRestricted,message,previousStrict,previousYieldAllowed,paramSet,generator;expectKeyword("function");generator=false;if(match("*")){lex();generator=true}token=lookahead();id=parseVariableIdentifier();if(strict){if(isRestrictedWord(token.value)){throwError(token,Messages.StrictFunctionName)}}else{if(isRestrictedWord(token.value)){firstRestricted=token;message=Messages.StrictFunctionName}else if(isStrictModeReservedWord(token.value)){firstRestricted=token;message=Messages.StrictReservedWord}}expect("(");if(!match(")")){paramSet={};while(index<length){token=lookahead();param=parseVariableIdentifier();if(strict){if(isRestrictedWord(token.value)){throwError(token,Messages.StrictParamName)}if(Object.prototype.hasOwnProperty.call(paramSet,token.value)){throwError(token,Messages.StrictParamDupe)}}else if(!firstRestricted){if(isRestrictedWord(token.value)){firstRestricted=token;message=Messages.StrictParamName}else if(isStrictModeReservedWord(token.value)){firstRestricted=token;message=Messages.StrictReservedWord}else if(Object.prototype.hasOwnProperty.call(paramSet,token.value)){firstRestricted=token;message=Messages.StrictParamDupe}}params.push(param);paramSet[param.name]=true;if(match(")")){break}expect(",")}}expect(")");previousStrict=strict;previousYieldAllowed=yieldAllowed;yieldAllowed=generator;body=parseFunctionSourceElements();if(strict&&firstRestricted){throwError(firstRestricted,message)}if(yieldAllowed&&!yieldFound){throwError({},Messages.NoYieldInGenerator)}strict=previousStrict;yieldAllowed=previousYieldAllowed;return{type:Syntax.FunctionDeclaration,id:id,params:params,defaults:[],body:body,rest:null,generator:generator,expression:false}}function parseFunctionExpression(){var token,id=null,firstRestricted,message,param,params=[],body,previousStrict,previousYieldAllowed,paramSet,generator;expectKeyword("function");generator=false;if(match("*")){lex();generator=true}if(!match("(")){token=lookahead();id=parseVariableIdentifier();if(strict){if(isRestrictedWord(token.value)){throwError(token,Messages.StrictFunctionName)}}else{if(isRestrictedWord(token.value)){firstRestricted=token;message=Messages.StrictFunctionName}else if(isStrictModeReservedWord(token.value)){firstRestricted=token;message=Messages.StrictReservedWord}}}expect("(");if(!match(")")){paramSet={};while(index<length){token=lookahead();param=parseVariableIdentifier();if(strict){if(isRestrictedWord(token.value)){throwError(token,Messages.StrictParamName)}if(Object.prototype.hasOwnProperty.call(paramSet,token.value)){throwError(token,Messages.StrictParamDupe)}}else if(!firstRestricted){if(isRestrictedWord(token.value)){firstRestricted=token;message=Messages.StrictParamName}else if(isStrictModeReservedWord(token.value)){firstRestricted=token;message=Messages.StrictReservedWord}else if(Object.prototype.hasOwnProperty.call(paramSet,token.value)){firstRestricted=token;message=Messages.StrictParamDupe}}params.push(param);paramSet[param.name]=true;if(match(")")){break}expect(",")}}expect(")");previousStrict=strict;previousYieldAllowed=yieldAllowed;yieldAllowed=generator;body=parseFunctionSourceElements();if(strict&&firstRestricted){throwError(firstRestricted,message)}if(yieldAllowed&&!yieldFound){throwError({},Messages.NoYieldInGenerator)}strict=previousStrict;yieldAllowed=previousYieldAllowed;return{type:Syntax.FunctionExpression,id:id,params:params,defaults:[],body:body,rest:null,generator:generator,expression:false}}function parseYieldExpression(){var delegate,expr,previousYieldAllowed;expectKeyword("yield");if(!yieldAllowed){throwErrorTolerant({},Messages.IllegalYield)}delegate=false;if(match("*")){lex();delegate=true}previousYieldAllowed=yieldAllowed;yieldAllowed=false;expr=parseAssignmentExpression();yieldAllowed=previousYieldAllowed;yieldFound=true;return{type:Syntax.YieldExpression,argument:expr,delegate:delegate}}function parseMethodDefinition(){var token,key,param;if(match("*")){lex();return{type:Syntax.MethodDefinition,key:parseObjectPropertyKey(),value:parsePropertyMethodFunction({generator:true}),kind:""}}token=lookahead();key=parseObjectPropertyKey();if(token.value==="get"&&!match("(")){key=parseObjectPropertyKey();expect("(");expect(")");return{type:Syntax.MethodDefinition,key:key,value:parsePropertyFunction([],{generator:false}),kind:"get"}}else if(token.value==="set"&&!match("(")){key=parseObjectPropertyKey();expect("(");token=lookahead();param=[parseVariableIdentifier()];expect(")");return{type:Syntax.MethodDefinition,key:key,value:parsePropertyFunction(param,{generator:false,name:token}),kind:"set"}}else{return{type:Syntax.MethodDefinition,key:key,value:parsePropertyMethodFunction({generator:false}),kind:""}}}function parseClassElement(){if(match(";")){lex();return}else{return parseMethodDefinition()}}function parseClassBody(){var classElement,classElements=[];expect("{");while(index<length){if(match("}")){break}classElement=parseClassElement();if(typeof classElement!=="undefined"){classElements.push(classElement)}}expect("}");return{type:Syntax.ClassBody,body:classElements}}function parseClassExpression(){var id,body,previousYieldAllowed,superClass;expectKeyword("class");if(!matchKeyword("extends")&&!match("{")){id=parseVariableIdentifier()}if(matchKeyword("extends")){expectKeyword("extends");previousYieldAllowed=yieldAllowed;yieldAllowed=false;superClass=parseAssignmentExpression();yieldAllowed=previousYieldAllowed}body=parseClassBody();return{id:id,type:Syntax.ClassExpression,body:body,superClass:superClass}}function parseClassDeclaration(){var token,id,body,previousYieldAllowed,superClass;expectKeyword("class");token=lookahead();id=parseVariableIdentifier();if(matchKeyword("extends")){expectKeyword("extends");previousYieldAllowed=yieldAllowed;yieldAllowed=false;superClass=parseAssignmentExpression();yieldAllowed=previousYieldAllowed}body=parseClassBody();return{id:id,type:Syntax.ClassDeclaration,body:body,superClass:superClass}}function parseSourceElement(){var token=lookahead();if(token.type===Token.Keyword){switch(token.value){case"const":case"let":return parseConstLetDeclaration(token.value);case"function":return parseFunctionDeclaration();default:return parseStatement()}}if(token.type!==Token.EOF){return parseStatement()}}function parseProgramElement(){var token=lookahead(),lineNumber;if(token.type===Token.Keyword){switch(token.value){case"export":return parseExportDeclaration();case"import":return parseImportDeclaration()}}if(token.value==="module"&&token.type===Token.Identifier){lineNumber=token.lineNumber;token=lookahead2();if(token.type===Token.Identifier&&token.lineNumber===lineNumber){return parseModuleDeclaration()}}return parseSourceElement()}function parseProgramElements(){var sourceElement,sourceElements=[],token,directive,firstRestricted;while(index<length){token=lookahead();if(token.type!==Token.StringLiteral){break}sourceElement=parseProgramElement();sourceElements.push(sourceElement);if(sourceElement.expression.type!==Syntax.Literal){break}directive=sliceSource(token.range[0]+1,token.range[1]-1);if(directive==="use strict"){strict=true;if(firstRestricted){throwError(firstRestricted,Messages.StrictOctalLiteral)}}else{if(!firstRestricted&&token.octal){firstRestricted=token}}}while(index<length){sourceElement=parseProgramElement();if(typeof sourceElement==="undefined"){break}sourceElements.push(sourceElement)}return sourceElements}function parseModuleElement(){return parseProgramElement()}function parseModuleElements(){var list=[],statement;while(index<length){if(match("}")){break}statement=parseModuleElement();if(typeof statement==="undefined"){break}list.push(statement)}return list}function parseModuleBlock(){var block;expect("{");block=parseModuleElements();expect("}");return{type:Syntax.BlockStatement,body:block}}function parseProgram(){var program;strict=false;yieldAllowed=false;yieldFound=false;program={type:Syntax.Program,body:parseProgramElements()};return program}function addComment(type,value,start,end,loc){assert(typeof start==="number","Comment must have valid position");if(extra.comments.length>0){if(extra.comments[extra.comments.length-1].range[1]>start){return}}extra.comments.push({type:type,value:value,range:[start,end],loc:loc})}function scanComment(){var comment,ch,loc,start,blockComment,lineComment;comment="";blockComment=false;lineComment=false;while(index<length){ch=source[index];if(lineComment){ch=nextChar();if(isLineTerminator(ch)){loc.end={line:lineNumber,column:index-lineStart-1};lineComment=false;addComment("Line",comment,start,index-1,loc);if(ch==="\r"&&source[index]==="\n"){++index}++lineNumber;lineStart=index;comment=""}else if(index>=length){lineComment=false;comment+=ch;loc.end={line:lineNumber,column:length-lineStart};addComment("Line",comment,start,length,loc)}else{comment+=ch}}else if(blockComment){if(isLineTerminator(ch)){if(ch==="\r"&&source[index+1]==="\n"){++index;comment+="\r\n"}else{comment+=ch}++lineNumber;++index;lineStart=index;if(index>=length){throwError({},Messages.UnexpectedToken,"ILLEGAL")}}else{ch=nextChar();if(index>=length){throwError({},Messages.UnexpectedToken,"ILLEGAL")}comment+=ch;if(ch==="*"){ch=source[index];if(ch==="/"){comment=comment.substr(0,comment.length-1);blockComment=false;++index;loc.end={line:lineNumber,column:index-lineStart};addComment("Block",comment,start,index,loc);comment=""}}}}else if(ch==="/"){ch=source[index+1];if(ch==="/"){loc={start:{line:lineNumber,column:index-lineStart}};start=index;index+=2;lineComment=true;if(index>=length){loc.end={line:lineNumber,column:index-lineStart};lineComment=false;addComment("Line",comment,start,index,loc)}}else if(ch==="*"){start=index;index+=2;blockComment=true;loc={start:{line:lineNumber,column:index-lineStart-2}};if(index>=length){throwError({},Messages.UnexpectedToken,"ILLEGAL")}}else{break}}else if(isWhiteSpace(ch)){++index}else if(isLineTerminator(ch)){++index;if(ch==="\r"&&source[index]==="\n"){++index}++lineNumber;lineStart=index}else{break}}}function filterCommentLocation(){var i,entry,comment,comments=[];for(i=0;i<extra.comments.length;++i){entry=extra.comments[i];comment={type:entry.type,value:entry.value};if(extra.range){comment.range=entry.range}if(extra.loc){comment.loc=entry.loc}comments.push(comment)}extra.comments=comments}function collectToken(){var start,loc,token,range,value;skipComment();start=index;loc={start:{line:lineNumber,column:index-lineStart}};token=extra.advance();loc.end={line:lineNumber,column:index-lineStart};if(token.type!==Token.EOF){range=[token.range[0],token.range[1]];value=sliceSource(token.range[0],token.range[1]);extra.tokens.push({type:TokenName[token.type],value:value,range:range,loc:loc})}return token}function collectRegex(){var pos,loc,regex,token;skipComment();pos=index;loc={start:{line:lineNumber,column:index-lineStart}};regex=extra.scanRegExp();loc.end={line:lineNumber,column:index-lineStart};if(extra.tokens.length>0){token=extra.tokens[extra.tokens.length-1];if(token.range[0]===pos&&token.type==="Punctuator"){if(token.value==="/"||token.value==="/="){extra.tokens.pop()}}}extra.tokens.push({type:"RegularExpression",value:regex.literal,range:[pos,index],loc:loc});return regex}function filterTokenLocation(){var i,entry,token,tokens=[];for(i=0;i<extra.tokens.length;++i){entry=extra.tokens[i];token={type:entry.type,value:entry.value};if(extra.range){token.range=entry.range}if(extra.loc){token.loc=entry.loc}tokens.push(token)}extra.tokens=tokens}function createLiteral(token){return{type:Syntax.Literal,value:token.value}}function createRawLiteral(token){return{type:Syntax.Literal,value:token.value,raw:sliceSource(token.range[0],token.range[1])}}function wrapTrackingFunction(range,loc){return function(parseFunction){function isBinary(node){return node.type===Syntax.LogicalExpression||node.type===Syntax.BinaryExpression}function visit(node){if(isBinary(node.left)){visit(node.left)}if(isBinary(node.right)){visit(node.right)}if(range&&typeof node.range==="undefined"){node.range=[node.left.range[0],node.right.range[1]]}if(loc&&typeof node.loc==="undefined"){node.loc={start:node.left.loc.start,end:node.right.loc.end}}}return function(){var node,rangeInfo,locInfo;skipComment();rangeInfo=[index,0];locInfo={start:{line:lineNumber,column:index-lineStart}};node=parseFunction.apply(null,arguments);if(typeof node!=="undefined"){if(range){rangeInfo[1]=index;node.range=rangeInfo}if(loc){locInfo.end={line:lineNumber,column:index-lineStart};node.loc=locInfo}if(isBinary(node)){visit(node)}if(node.type===Syntax.MemberExpression){if(typeof node.object.range!=="undefined"){node.range[0]=node.object.range[0]}if(typeof node.object.loc!=="undefined"){node.loc.start=node.object.loc.start}}if(node.type===Syntax.CallExpression){if(typeof node.callee.range!=="undefined"){node.range[0]=node.callee.range[0]}if(typeof node.callee.loc!=="undefined"){node.loc.start=node.callee.loc.start}}return node}}}}function patch(){var wrapTracking;if(extra.comments){extra.skipComment=skipComment;skipComment=scanComment}if(extra.raw){extra.createLiteral=createLiteral;createLiteral=createRawLiteral}if(extra.range||extra.loc){wrapTracking=wrapTrackingFunction(extra.range,extra.loc);extra.parseAdditiveExpression=parseAdditiveExpression;extra.parseAssignmentExpression=parseAssignmentExpression;extra.parseBitwiseANDExpression=parseBitwiseANDExpression;extra.parseBitwiseORExpression=parseBitwiseORExpression;extra.parseBitwiseXORExpression=parseBitwiseXORExpression;extra.parseBlock=parseBlock;extra.parseFunctionSourceElements=parseFunctionSourceElements;extra.parseCallMember=parseCallMember;extra.parseCatchClause=parseCatchClause;extra.parseComputedMember=parseComputedMember;extra.parseConditionalExpression=parseConditionalExpression;extra.parseConstLetDeclaration=parseConstLetDeclaration;extra.parseEqualityExpression=parseEqualityExpression;extra.parseExportDeclaration=parseExportDeclaration;extra.parseExportSpecifier=parseExportSpecifier;extra.parseExportSpecifierSetProperty=parseExportSpecifierSetProperty;extra.parseExpression=parseExpression;extra.parseForVariableDeclaration=parseForVariableDeclaration;extra.parseFunctionDeclaration=parseFunctionDeclaration;extra.parseFunctionExpression=parseFunctionExpression;extra.parseGlob=parseGlob;extra.parseImportDeclaration=parseImportDeclaration;extra.parseImportSpecifier=parseImportSpecifier;extra.parseLogicalANDExpression=parseLogicalANDExpression;extra.parseLogicalORExpression=parseLogicalORExpression;extra.parseMultiplicativeExpression=parseMultiplicativeExpression;extra.parseModuleDeclaration=parseModuleDeclaration;extra.parseModuleBlock=parseModuleBlock;extra.parseNewExpression=parseNewExpression;extra.parseNonComputedMember=parseNonComputedMember;extra.parseNonComputedProperty=parseNonComputedProperty;extra.parseObjectProperty=parseObjectProperty;extra.parseObjectPropertyKey=parseObjectPropertyKey;extra.parsePath=parsePath;extra.parsePostfixExpression=parsePostfixExpression;extra.parsePrimaryExpression=parsePrimaryExpression;extra.parseProgram=parseProgram;extra.parsePropertyFunction=parsePropertyFunction;extra.parseRelationalExpression=parseRelationalExpression;extra.parseQuasiElement=parseQuasiElement;extra.parseQuasiLiteral=parseQuasiLiteral;extra.parseStatement=parseStatement;extra.parseShiftExpression=parseShiftExpression;extra.parseSwitchCase=parseSwitchCase;extra.parseTaggedQuasi=parseTaggedQuasi;extra.parseUnaryExpression=parseUnaryExpression;extra.parseVariableDeclaration=parseVariableDeclaration;extra.parseVariableIdentifier=parseVariableIdentifier;extra.parseMethodDefinition=parseMethodDefinition;extra.parseClassDeclaration=parseClassDeclaration;extra.parseClassExpression=parseClassExpression;extra.parseClassBody=parseClassBody;parseAdditiveExpression=wrapTracking(extra.parseAdditiveExpression);parseAssignmentExpression=wrapTracking(extra.parseAssignmentExpression);parseBitwiseANDExpression=wrapTracking(extra.parseBitwiseANDExpression);parseBitwiseORExpression=wrapTracking(extra.parseBitwiseORExpression);parseBitwiseXORExpression=wrapTracking(extra.parseBitwiseXORExpression);parseBlock=wrapTracking(extra.parseBlock);parseFunctionSourceElements=wrapTracking(extra.parseFunctionSourceElements);parseCallMember=wrapTracking(extra.parseCallMember);parseCatchClause=wrapTracking(extra.parseCatchClause);parseComputedMember=wrapTracking(extra.parseComputedMember);parseConditionalExpression=wrapTracking(extra.parseConditionalExpression);parseConstLetDeclaration=wrapTracking(extra.parseConstLetDeclaration);parseExportDeclaration=wrapTracking(parseExportDeclaration);parseExportSpecifier=wrapTracking(parseExportSpecifier);parseExportSpecifierSetProperty=wrapTracking(parseExportSpecifierSetProperty);parseEqualityExpression=wrapTracking(extra.parseEqualityExpression);parseExpression=wrapTracking(extra.parseExpression);parseForVariableDeclaration=wrapTracking(extra.parseForVariableDeclaration);parseFunctionDeclaration=wrapTracking(extra.parseFunctionDeclaration);parseFunctionExpression=wrapTracking(extra.parseFunctionExpression);parseGlob=wrapTracking(extra.parseGlob);parseImportDeclaration=wrapTracking(extra.parseImportDeclaration);parseImportSpecifier=wrapTracking(extra.parseImportSpecifier);parseLogicalANDExpression=wrapTracking(extra.parseLogicalANDExpression);parseLogicalORExpression=wrapTracking(extra.parseLogicalORExpression);parseMultiplicativeExpression=wrapTracking(extra.parseMultiplicativeExpression);parseModuleDeclaration=wrapTracking(extra.parseModuleDeclaration);parseModuleBlock=wrapTracking(extra.parseModuleBlock);parseNewExpression=wrapTracking(extra.parseNewExpression);parseNonComputedMember=wrapTracking(extra.parseNonComputedMember);parseNonComputedProperty=wrapTracking(extra.parseNonComputedProperty);parseObjectProperty=wrapTracking(extra.parseObjectProperty);parseObjectPropertyKey=wrapTracking(extra.parseObjectPropertyKey);parsePath=wrapTracking(extra.parsePath);parsePostfixExpression=wrapTracking(extra.parsePostfixExpression);parsePrimaryExpression=wrapTracking(extra.parsePrimaryExpression);parseProgram=wrapTracking(extra.parseProgram);parsePropertyFunction=wrapTracking(extra.parsePropertyFunction);parseQuasiElement=wrapTracking(extra.parseQuasiElement);parseQuasiLiteral=wrapTracking(extra.parseQuasiLiteral);parseRelationalExpression=wrapTracking(extra.parseRelationalExpression);parseStatement=wrapTracking(extra.parseStatement);parseShiftExpression=wrapTracking(extra.parseShiftExpression);parseSwitchCase=wrapTracking(extra.parseSwitchCase);parseTaggedQuasi=wrapTracking(extra.parseTaggedQuasi);parseUnaryExpression=wrapTracking(extra.parseUnaryExpression);parseVariableDeclaration=wrapTracking(extra.parseVariableDeclaration);parseVariableIdentifier=wrapTracking(extra.parseVariableIdentifier);parseMethodDefinition=wrapTracking(extra.parseMethodDefinition);parseClassDeclaration=wrapTracking(extra.parseClassDeclaration);parseClassExpression=wrapTracking(extra.parseClassExpression);parseClassBody=wrapTracking(extra.parseClassBody)}if(typeof extra.tokens!=="undefined"){extra.advance=advance;extra.scanRegExp=scanRegExp;advance=collectToken;scanRegExp=collectRegex}}function unpatch(){if(typeof extra.skipComment==="function"){skipComment=extra.skipComment}if(extra.raw){createLiteral=extra.createLiteral}if(extra.range||extra.loc){parseAdditiveExpression=extra.parseAdditiveExpression;parseAssignmentExpression=extra.parseAssignmentExpression;parseBitwiseANDExpression=extra.parseBitwiseANDExpression;parseBitwiseORExpression=extra.parseBitwiseORExpression;parseBitwiseXORExpression=extra.parseBitwiseXORExpression;parseBlock=extra.parseBlock;parseFunctionSourceElements=extra.parseFunctionSourceElements;parseCallMember=extra.parseCallMember;parseCatchClause=extra.parseCatchClause;parseComputedMember=extra.parseComputedMember;parseConditionalExpression=extra.parseConditionalExpression;parseConstLetDeclaration=extra.parseConstLetDeclaration;parseEqualityExpression=extra.parseEqualityExpression;parseExportDeclaration=extra.parseExportDeclaration;parseExportSpecifier=extra.parseExportSpecifier;parseExportSpecifierSetProperty=extra.parseExportSpecifierSetProperty;parseExpression=extra.parseExpression;parseForVariableDeclaration=extra.parseForVariableDeclaration;parseFunctionDeclaration=extra.parseFunctionDeclaration;parseFunctionExpression=extra.parseFunctionExpression;parseGlob=extra.parseGlob;parseImportDeclaration=extra.parseImportDeclaration;parseImportSpecifier=extra.parseImportSpecifier;parseLogicalANDExpression=extra.parseLogicalANDExpression;parseLogicalORExpression=extra.parseLogicalORExpression;parseMultiplicativeExpression=extra.parseMultiplicativeExpression;parseModuleDeclaration=extra.parseModuleDeclaration;parseModuleBlock=extra.parseModuleBlock;parseNewExpression=extra.parseNewExpression;parseNonComputedMember=extra.parseNonComputedMember;parseNonComputedProperty=extra.parseNonComputedProperty;parseObjectProperty=extra.parseObjectProperty;parseObjectPropertyKey=extra.parseObjectPropertyKey;parsePath=extra.parsePath;parsePostfixExpression=extra.parsePostfixExpression;parsePrimaryExpression=extra.parsePrimaryExpression;parseProgram=extra.parseProgram;parsePropertyFunction=extra.parsePropertyFunction;parseQuasiElement=extra.parseQuasiElement;parseQuasiLiteral=extra.parseQuasiLiteral;parseRelationalExpression=extra.parseRelationalExpression;parseStatement=extra.parseStatement;parseShiftExpression=extra.parseShiftExpression;parseSwitchCase=extra.parseSwitchCase;parseTaggedQuasi=extra.parseTaggedQuasi;parseUnaryExpression=extra.parseUnaryExpression;parseVariableDeclaration=extra.parseVariableDeclaration;parseVariableIdentifier=extra.parseVariableIdentifier;parseMethodDefinition=extra.parseMethodDefinition;parseClassDeclaration=extra.parseClassDeclaration;parseClassExpression=extra.parseClassExpression;parseClassBody=extra.parseClassBody}if(typeof extra.scanRegExp==="function"){advance=extra.advance;scanRegExp=extra.scanRegExp}}function stringToArray(str){var length=str.length,result=[],i;for(i=0;i<length;++i){result[i]=str.charAt(i)}return result}function parse(code,options){var program,toString;toString=String;if(typeof code!=="string"&&!(code instanceof String)){code=toString(code)}source=code;index=0;lineNumber=source.length>0?1:0;lineStart=0;length=source.length;buffer=null;state={allowIn:true,labelSet:{},parenthesizedCount:0,lastParenthesized:null,inFunctionBody:false,inIteration:false,inSwitch:false};extra={};if(typeof options!=="undefined"){extra.range=typeof options.range==="boolean"&&options.range;extra.loc=typeof options.loc==="boolean"&&options.loc;extra.raw=typeof options.raw==="boolean"&&options.raw;if(typeof options.tokens==="boolean"&&options.tokens){extra.tokens=[]}if(typeof options.comment==="boolean"&&options.comment){extra.comments=[]}if(typeof options.tolerant==="boolean"&&options.tolerant){extra.errors=[]}}if(length>0){if(typeof source[0]==="undefined"){if(code instanceof String){source=code.valueOf()}if(typeof source[0]==="undefined"){source=stringToArray(code)}}}patch();try{program=parseProgram();if(typeof extra.comments!=="undefined"){filterCommentLocation();program.comments=extra.comments}if(typeof extra.tokens!=="undefined"){filterTokenLocation();program.tokens=extra.tokens}if(typeof extra.errors!=="undefined"){program.errors=extra.errors}}catch(e){throw e}finally{unpatch();extra={}}return program}exports.version="1.0.0-dev-harmony";exports.parse=parse;exports.Syntax=function(){var name,types={};if(typeof Object.create==="function"){types=Object.create(null)}for(name in Syntax){if(Syntax.hasOwnProperty(name)){types[name]=Syntax[name]}}if(typeof Object.freeze==="function"){Object.freeze(types)}return types}()})};require["./harmonizr"]=new function(){var exports=this;var esprima=require("./esom/esprima"),parse=esprima.parse,Syntax=esprima.Syntax;function harmonize(src,options){options=options||{};src=processShorthands(src,options);src=processMethods(src,options);src=processArrowFunctions(src,options);src=processDestructuringAssignments(src,options);src=processModules(src,options,moduleStyles[options.style]);return src}function processShorthands(src,options){var ast=parse(src,{loc:true});var lines=src.split("\n");var shorthands=[];traverse(ast,function(node){if(node.type===Syntax.Property&&node.shorthand){shorthands.push(node)}});for(var i=shorthands.length-1;i>=0;i--){var prop=shorthands[i];var line=prop.value.loc.end.line-1;var col=prop.value.loc.end.column;lines[line]=splice(lines[line],col,0,": "+prop.value.name)}return lines.join("\n")}function processMethods(src,options){var ast=parse(src,{loc:true});var lines=src.split("\n");var methods=[];traverse(ast,function(node){if(node.type===Syntax.Property&&node.method){methods.push(node)}});for(var i=methods.length-1;i>=0;i--){var prop=methods[i];var line=prop.key.loc.end.line-1;var col=prop.key.loc.end.column;if(prop.value.body.type!==Syntax.BlockStatement){var bodyEndLine=prop.value.loc.end.line-1;var bodyEndCol=prop.value.loc.end.column;lines[bodyEndLine]=splice(lines[bodyEndLine],bodyEndCol,0,"; }");var prefix="{ ";if(prop.value.body.type!==Syntax.AssignmentExpression){prefix+="return "}var bodyStartLine=prop.value.loc.start.line-1;var bodyStartCol=prop.value.loc.start.column;lines[bodyStartLine]=splice(lines[bodyStartLine],bodyStartCol,0,prefix)}lines[line]=splice(lines[line],col,0,": function")}return lines.join("\n")}function processArrowFunctions(src,options){var ast=parse(src,{loc:true});var lines=src.split("\n");var arrowFunctions=[];traverse(ast,function(node){if(node.type===Syntax.ArrowFunctionExpression){arrowFunctions.push(node)}});arrowFunctions.reverse();arrowFunctions.forEach(function(node){var bodyEndLine=node.body.loc.end.line-1;var bodyEndCol=node.body.loc.end.column;var needsBind=containsThisExpression(node);if(needsBind){lines[bodyEndLine]=splice(lines[bodyEndLine],bodyEndCol,0,".bind(this)")}var needsCurly=lines[bodyEndLine].charAt(bodyEndCol-1)!=="}";if(needsCurly){lines[bodyEndLine]=splice(lines[bodyEndLine],bodyEndCol,0,"; }")}});arrowFunctions.forEach(function(node){var startLine=node.loc.start.line-1;var startCol=node.loc.start.column;var lastParam,paramsEndLine,paramsEndCol;if(node.params.length){lastParam=node.params[node.params.length-1];paramsEndLine=lastParam.loc.end.line-1;paramsEndCol=lastParam.loc.end.column}var bodyStartLine=node.body.loc.start.line-1;var bodyStartCol=node.body.loc.start.column;var needsCurly=lines[bodyStartLine].charAt(bodyStartCol)!=="{";if(needsCurly){lines[bodyStartLine]=splice(lines[bodyStartLine],bodyStartCol,0,"{ return ")}lines[bodyStartLine]=splice(lines[bodyStartLine],bodyStartCol,0,") ");if(node.params.length){lines[paramsEndLine]=splice(lines[paramsEndLine],paramsEndCol,bodyStartCol-paramsEndCol,"");var n=paramsEndLine;while(n++<bodyStartLine){if(n<bodyStartLine){lines[n]=""}else{lines[n]=splice(lines[n],0,bodyStartCol,"")}}var endsWithParen=lines[paramsEndLine].charAt(paramsEndCol-1)===")";if(endsWithParen){lines[paramsEndLine]=splice(lines[paramsEndLine],paramsEndCol-1,1,"")}}else{lines[startLine]=splice(lines[startLine],startCol+1,bodyStartCol-startCol-1,"")}if(lines[startLine].charAt(startCol)==="("){lines[startLine]=splice(lines[startLine],startCol,1,"")}lines[startLine]=splice(lines[startLine],startCol,0,"function(")});return lines.join("\n");function containsThisExpression(node){var result=false;traverse(node,function(innerNode){if(innerNode.type===Syntax.ThisExpression){result=true}else if(innerNode!==node&&innerNode.type===Syntax.ArrowFunctionExpression){return false}});return result}}function processDestructuringAssignments(src,options){var ast=parse(src,{loc:true});var lines=src.split("\n");var nodes=[];traverse(ast,function(node){if(node.type===Syntax.AssignmentExpression&&node.left.type===Syntax.ArrayPattern){nodes.push(node)}});nodes.reverse();nodes.forEach(function(node){var firstId=node.left.elements[0].name;var endLine=node.loc.end.line-1;var endCol=node.loc.end.column;lines[endLine]=splice(lines[endLine],endCol,0,", "+getAssignments());var patternStartLine=node.left.loc.start.line-1;var patternStartCol=node.left.loc.start.column;var patternEndCol=node.left.loc.end.column;lines[patternStartLine]=splice(lines[patternStartLine],patternStartCol,patternEndCol-patternStartCol,firstId);function getAssignments(){var all=[];for(var i=1;i<node.left.elements.length;i++){var id=node.left.elements[i].name;all.push(getAssignment(id,i))}all.push(getAssignment(firstId,0));return all.join(", ")}function getAssignment(id,index){return id+" = "+firstId+"["+index+"]"}});return lines.join("\n")}function processModules(src,options,style){if(!style){return src}if(options.module){src="module "+options.module+"{"+src+"\n}"}var ast=parse(src,{loc:true});var lines=src.split("\n");var modules=[];traverse(ast,function(node){if(node.type===Syntax.ModuleDeclaration){modules.push(node);return false}});modules.forEach(function(mod){options.indent=detectIndent(mod,lines);var imps=[];traverse(mod,function(node){if(node.type===Syntax.ModuleDeclaration){if(node.id&&node.from){imps.push(node)}else if(node!==mod){return false}}else if(node.type===Syntax.ImportDeclaration&&node.specifiers[0].type!==Syntax.Glob){imps.push(node)}});var moduleStartLine=mod.loc.start.line-1;var moduleStartColumn=mod.loc.start.column;var moduleEndLine=mod.loc.end.line-1;var moduleEndColumn=mod.loc.end.column;var bodyStartColumn=mod.body.loc.start.column;var bodyEndColumn=mod.body.loc.end.column;lines[moduleEndLine]=splice(lines[moduleEndLine],bodyEndColumn-1,1,style.endModule(mod,options));imps.forEach(function(imp){var importStartLine=imp.loc.start.line-1;var importStartColumn=imp.loc.start.column;var importEndColumn=imp.loc.end.column;lines[importStartLine]=splice(lines[importStartLine],importStartColumn,importEndColumn-importStartColumn,imp.type===Syntax.ModuleDeclaration?style.importModuleDeclaration(mod,imp,options):style.importDeclaration(mod,imp,options))});var exps=[];traverse(mod,function(node){if(node.type===Syntax.ModuleDeclaration&&node!==mod){return false}else if(node.type===Syntax.ExportDeclaration){exps.push(node)}});exps.forEach(function(exp){var exportStartLine=exp.loc.start.line-1;var exportStartColumn=exp.loc.start.column;var declarationStartColumn=exp.declaration.loc.start.column;lines[exportStartLine]=splice(lines[exportStartLine],exportStartColumn,declarationStartColumn-exportStartColumn,"")});if(exps.length){lines[moduleEndLine]=splice(lines[moduleEndLine],moduleEndColumn-1,0,style.exports(mod,exps,options))}lines[moduleStartLine]=splice(lines[moduleStartLine],moduleStartColumn,bodyStartColumn-moduleStartColumn+1,style.startModule(mod,imps,options))});src=lines.join("\n");return src}var moduleStyles={amd:{startModule:function(mod,imps,options){var header="define(";if(imps.length){header+="['"+imps.map(function(imp){return modulePath(importFrom(imp),options)}).join("', '")+"'], "}header+="function(";if(imps.length){header+=imps.map(function(imp){return importFrom(imp)}).join(", ")}header+=") {";return header},importModuleDeclaration:function(mod,imp,options){return"var "+imp.id.name+" = "+importFrom(imp)+";"},importDeclaration:function(mod,imp,options){return"var "+imp.specifiers.map(function(spec){var id=spec.type===Syntax.Identifier?spec.name:spec.id.name;var from=spec.from?joinPath(spec.from):id;return id+" = "+importFrom(imp)+"."+from}).join(", ")+";"},exports:function(mod,exps,options){var indent1=options.module?"":options.indent;var indent2=options.indent;var ret="\n"+indent1;ret+="return {";if(exps.length){ret+="\n";ret+=exps.map(function(exp){var id=exportName(exp);return indent1+indent2+id+": "+id}).join(",\n");ret+="\n";ret+=indent1}ret+="};\n";return ret},endModule:function(mod,options){return"});"}},node:{startModule:function(mod,imps,options){return""},importModuleDeclaration:function(mod,imp,options){return"var "+imp.id.name+" = require('"+importFrom(imp)+"');"},importDeclaration:function(mod,imp,options){return"var "+importFrom(imp)+" = require('"+modulePath(importFrom(imp),options)+"'), "+imp.specifiers.map(function(spec){var id=spec.type===Syntax.Identifier?spec.name:spec.id.name;var from=spec.from?joinPath(spec.from):id;return id+" = "+importFrom(imp)+"."+from}).join(", ")+";"},exports:function(mod,exps,options){var indent1=options.module?"":options.indent;var indent2=options.indent;var returns="\n"+indent1+"module.exports = {";returns+="\n"+exps.map(function(exp){var id=exportName(exp);return indent1+indent2+id+": "+id}).join(",\n");returns+="\n"+indent1;returns+="};\n";return returns},endModule:function(mod,options){return""}},revealing:{startModule:function(mod,imps,options){return"var "+mod.id.name+" = function() {"},importModuleDeclaration:function(mod,imp,options){return"var "+imp.id.name+" = "+importFrom(imp)+";"},importDeclaration:function(mod,imp,options){return"var "+imp.specifiers.map(function(spec){var id=spec.type===Syntax.Identifier?spec.name:spec.id.name;var from=spec.from?joinPath(spec.from):id;return id+" = "+importFrom(imp)+"."+from}).join(", ")+";"},exports:function(mod,exps,options){var indent1=options.module?"":options.indent;var indent2=options.indent;var returns="\n"+indent1+"return {";if(exps.length){returns+="\n"+exps.map(function(exp){var id=exportName(exp);return indent1+indent2+id+": "+id}).join(",\n");returns+="\n"+indent1}returns+="};\n";return returns},endModule:function(mod,options){return"}();"}}};function traverse(node,visitor){if(visitor(node)===false){return}Object.keys(node).forEach(function(key){var child=node[key];if(child&&typeof child==="object"){traverse(child,visitor)}})}function modulePath(moduleName,options){var isRelative=options.relatives&&options.relatives.indexOf(moduleName)!==-1;return(isRelative?"./":"")+moduleName}function importFrom(imp){if(imp.from.type===Syntax.Path){return imp.from.body[0].name}else{return imp.from.value}}function exportName(exp){if(exp.declaration.type===Syntax.VariableDeclaration){return exp.declaration.declarations[0].id.name}else if(exp.declaration.type===Syntax.FunctionDeclaration){return exp.declaration.id.name}}function joinPath(path){return path.body.map(function(id){return id.name}).join(".")}function splice(str,index,howMany,insert){var a=str.split("");a.splice(index,howMany,insert);return a.join("")}function detectIndent(mod,lines){var i=0;while(i<lines.length){var line=lines[i];var m=line.match(/^(\s+)\S/);if(m){return m[1]}i++}return""}exports.harmonize=harmonize,exports.moduleStyles=moduleStyles};require["./helpers"]=new function(){var exports=this;exports.extend=function(object,properties){var key,val;for(key in properties){val=properties[key];object[key]=val}return object}};require["./filters/egal"]=new function(){var exports=this;exports.filter=function anonymous(it){var out="("+(it.ast.operator==="isnt"?"!":"")+"function ( x, y ) {return (x === y)?( x !== 0 || 1/x === 1/y ) : ( x !== x && y !==y )}( "+it.first().compile()+", "+it.last().compile()+" ))";return out}};require["./filters/quasi"]=new function(){var exports=this;exports.filter=function anonymous(it){var out='"';var arr1=it.select(".QuasiElement");if(arr1){var child,index=-1,l1=arr1.length-1;while(index<l1){child=arr1[index+=1];out+=" "+child.ast.value.raw+" ";if(it.select("expressions")[0]&&it.select("expressions")[0].children[index]){out+=' " + '+it.select("expressions")[0].children[index].compile()+' + " '}}}out+='"';return out}};require["./filters/class"]=new function(){var exports=this;exports.filter=function anonymous(it){var out="";var id=it.id?it.id.compile():"_Class";var dec=it.type==="ClassDeclaration";if(dec){out+="var "+id+" ="}out+="(function(";if(it.superClass){out+="_super"}out+=") {";if(it.superClass){out+="function __ctor() { this.constructor = "+id+"; }__ctor.prototype = _super.prototype;"+id+".prototype = new __ctor();"+id+".__super__ = _super.prototype;"}out+="function "+id+"(";if(it.constructor){if(it.constructor.value.params&&it.constructor.value.params.ast){out+=it.constructor.value.params.compile()}out+=")"+it.constructor.value.body.compile()}else{out+="){}"}var arr1=it.methods;if(arr1){var method,index=-1,l1=arr1.length-1;while(index<l1){method=arr1[index+=1];var params=method.value.params&&method.value.params.ast;if(method.kind==="set"||method.kind==="get"){out+="Object.defineProperty("+id+'.prototype, "'+method.key.compile()+'", {configurable: true,enumerable: true,'+method.kind+": function(";if(params){out+=method.value.params.compile()}out+=")"+method.value.body.compile()+"});"}else{out+=id+".prototype."+method.key.compile()+" = function(";if(params){out+=method.value.params.compile()}out+=")"+method.value.body.compile()+";"}}}out+="return "+id+";})(";if(it.superClass){out+=it.superClass.compile()}out+=")";if(dec){out+=";"}return out}};require["./filters"]=new function(){var exports=this;var filters=exports.filters={egal:require("./filters/egal").filter,quasi:require("./filters/quasi").filter,"class":require("./filters/class").filter}};require["./esom/rel"]=require["./rel"]=new function(){var exports=this;var Relatives={first:function(){return this.children[0]},last:function(){return this.children[this.children.length-1]},next:function(){var siblings=this.parent.children;return siblings[siblings.indexOf(this)+1]},prev:function(){var siblings=this.parent.children;return siblings[siblings.indexOf(this)-1]},deepest:function(){var deepest=[];this.children.forEach(function(child){!child.children.length?deepest.push(child):child.deepest.forEach(function(child){return deepest.push(child)})});return deepest}};exports.Relatives=Relatives};require["./esom/trav"]=require["./trav"]=new function(){var exports=this;var Query,Traversal,queryPat=/((?:[\>|\+][\s]*)?(?=[\w|\.])(?:[A-Za-z]+)?(?:\.[A-Za-z]+)?(?:\[[\w]+(?:(?:[*|^|$]?=?(?!\]))(?:[0-9]+(?=\]))?(?:['"][\w]+['"](?=\]))?(?:true|false(?=\]))?)?\])*(?:\:(?!$)(?:[\w]+)(?:\((?:[\s\S]+)\))?)*)/g,queryMatch=/^(?:([\>|\+])[\s]*)?(?=[\w|\.])([A-Za-z]+)?(?:\.([A-Za-z]+))?((?:\[[\w]+(?:(?:[*|^|$]?=?(?!\]))(?:[0-9]+(?=\]))?(?:['"][\w]+['"](?=\]))?(?:true|false(?=\]))?)?\])*)((?:\:(?!$)(?:[\w]+)(?:\((?:[\s\S]+)\))?)*)$/,tagPat="([A-Za-z]+)?",classPat="(?:.([A-Za-z]+))?",relPat="(?:([>|+])[s]*)?(?=[w|.])",propPat="(?:[[w]+(?:(?:[*|^|$]?=?(?!]))(?:[0-9]+(?=]))?(?:['\"][w]+['\"](?=]))?(?:true|false(?=]))?)?])*",pseudoPat="(?::(?!$)(?:[w]+)(?:((?:[sS]+)))?)*",attrPat=/^([\w]+)(?:(?:([*|^|$]?=)?(?!\]))(?:([0-9]+)(?=\]))?(?:['"]([\w]+)['"](?=\]))?(?:(true|false)(?=\]))?)?\]$/;function parse(selector){return new Query(queryMatch.exec(selector))}Query=function(){function Query(dir){this.dir=dir;this.ret={};this.relative();this.key();this.type();this.properties();this.pseudos();return this.ret}Query.prototype.relative=function(){switch(this.dir[1]){case">":this.ret.child=true;break;case"+":this.ret.sibling=true;break}};Query.prototype.key=function(){if(this.dir[2])this.ret.key=this.dir[2]};Query.prototype.type=function(){if(this.dir[3])this.ret.type=this.dir[3]};Query.prototype.properties=function(){if(this.dir[4]){this.ret.properties=[];this.dir[4].split("[").forEach(function(prop){if(prop)this.property(prop)}.bind(this))}};Query.prototype.property=function(prop){var parts=attrPat.exec(prop);var obj={};if(parts&&parts[1]){obj.property=parts[1];if(parts[2]){obj.operation=parts[2];if(parts[3])obj.value=Number(parts[3]);else if(parts[4])obj.value=parts[4];else if(parts[5])obj.value=Boolean(parts[5])}this.ret.properties.push(obj)}};Query.prototype.pseudos=function(){var pat=/(?:\:([\w]+)(?:\(([\s\S]+)\))?)/g;var pat2=/(?:\:([\w]+)(?:\(([\s\S]+)\))?)/;if(this.dir[5]){this.ret.pseudos=[];this.dir[5].match(pat).forEach(function(seg){var parts=pat2.exec(seg);var obj={};if(parts&&parts[1]){obj.pseudo=parts[1];if(parts[2])obj.argument=parts[2];this.ret.pseudos.push(obj)}}.bind(this))}};return Query}();Traversal={select:function(query,frags){var results=[];var sels=query.match(queryPat);var sel=sels.pop();var dir=parse(sel);frags=frags||sels;this.children.forEach(function(child){if(dir.child&&child.matches(dir)){var pass=true;var cur=child;frags.reverse().forEach(function(frag){var dir=parse(frag);if(pass&dir.child){if(cur.parent.matches(dir)){cur=cur.parent}else{pass=false}}});if(pass)results.push(child)}else if(child.matches(sel)){results.push(child)}child.select(sel,frags).forEach(function(child){return results.push(child)})});void function enhance(sel){if(sels.length){sel=sels.pop();results=results.filter(function(node){return node.closest(sel)?true:false});enhance()}}();return results},closest:function(selector){var dir=parse(selector);var closest;if(this.parent&&this.parent!==this.root){closest=this.parent.matches(selector)?this.parent:this.parent.closest(selector)}return closest},matches:function(dir){var match=true;if(typeof dir==="string")return this.matches(parse(dir));if(match&&dir.key&&this.key!==dir.key)match=false;if(match&&dir.type&&this.ast.type!==dir.type)match=false;if(dir.properties)dir.properties.forEach(function(prop){if(match&&prop.property&&typeof this.ast[prop.property]==="undefined")match=false;if(match&&prop.property&&prop.operation&&typeof prop.value!=="undefined"){if(prop.operation==="="&&this.ast[prop.property]!==prop.value)match=false;else if(typeof this.ast[prop.property]==="string"){switch(prop.operation){case"^=":if(!this.ast[prop.property].match("^"+prop.value))match=false;break;case"$=":if(!this.ast[prop.property].match(prop.value+"$"))match=false;break;case"*=":if(!~this.ast[prop.property].indexOf(prop.value))match=false;break}}}}.bind(this));return match}};Object.define(Traversal,require("./rel").Relatives);exports.Traversal=Traversal};require["./esom/tree"]=require["./tree"]=new function(){var exports=this;var esprima=require("./esprima"),parse=esprima.parse,Syntax=esprima.Syntax,Tree=function(){function Tree(source){var ast=parse(source,{loc:true});Object.define(this,{root:this,get source(){return source},get ast(){return ast}});return this.create({ast:ast,key:"root",type:"Node"})}Tree.prototype.create=function(base){var node=Object.create(this.root);var parent=this;var children=[];Object.define(node,base);node.climb(function(child){if(child.type==="Node"||child.type==="NodeSet"&&child.ast.length){if(child.type==="NodeSet"){child.ast.loc={start:child.ast[0].loc.start,end:child.ast[child.ast.length-1].loc.end}}children.push(node.create(child))}});Object.define(node,{get ast(){return base.ast},get parent(){return parent},get children(){return children.slice(0)}});return node};Tree.prototype.climb=function(visit){var node=this.ast;Object.keys(node).forEach(function(key){var ast=node[key],type;if(ast&&typeof ast==="object"){type=ast.type?"Node":Array.isArray(ast)?"NodeSet":"Unknown";visit({key:key,ast:ast,type:type})}})};Tree.prototype.loc=function(){return this.ast.loc};Tree.prototype.lines=function(){return this.source.split("\n")};Tree.prototype.raw=function(){return extract(this.lines(),this.loc().start,this.loc().end)};Tree.prototype.isRoot=function(){return this.parent===this.root};Tree.prototype.path=function(){return this.isRoot()?"":this.parent.path+"."+this.key};return Tree}();function extract(lines,from,to){var lineno,ret=[];if(from.line===to.line){ret.push(lines[from.line-1].substring(from.column,to.column))}else{ret.push(lines[from.line-1].substring(from.column));for(lineno=from.line;lineno<to.line-1;lineno++)ret.push(lines[lineno]);ret.push(lines[to.line-1].substring(0,to.column))}return ret.join("\n")}Object.define(Tree,{create:function(src){return new this(src)}});Object.define(Tree.prototype,require("./trav").Traversal);exports.Tree=Tree};require["./rewriter"]=new function(){var exports=this;var Tree=require("./esom/tree").Tree,filters=require("./filters").filters,uglify=require("uglify-js"),jsp=uglify.parser,pro=uglify.uglify;function rewrite(src){var program=Tree.create(src);program.select(".BinaryExpression[operator^='is']").forEach(function(node){return node.compile=function(){return filters.egal(node)}});program.select(".QuasiLiteral").forEach(function(node){return node.compile=function(){return filters.quasi(node)}});function ClassRewrite(node){var constructor,ctx=node.context(),methods=[];if(ctx.body&&ctx.body.body){ctx.body.body.node.children.forEach(function(child){var sub=child.context();if(sub.key.node.matches(".Identifier[name='constructor']"))constructor=sub;else methods.push(sub)})}Object.define(ctx,{get constructor(){return constructor},get methods(){return methods}});return filters.class(ctx)}program.select(".ClassDeclaration").forEach(function(node){return node.compile=function(){return ClassRewrite(node)}});program.select(".ClassExpression").forEach(function(node){return node.compile=function(){return ClassRewrite(node)}});program.select(".CallExpression > .MemberExpression > .Identifier[name='super']").forEach(function(node){var argsc,Call=node.closest(".CallExpression").context(),callee=Call.callee,args=Call.arguments;if(args&&args.compile){argsc=args=args.compile()}node.compile=function(){return"this.constructor.__super__"};callee.property.node.compile=function(){return callee.property.name+".call"};if(args&&args.node)args.node.compile=function(){return"this"+(args.node?","+argsc:"")}});program.select(".CallExpression > callee[name='super']").forEach(function(node){var Call=node.parent.context(),args=Call.arguments;if(args&&args.compile){args=args.compile()}Call.node.compile=function(){return"this.constructor.__super__.constructor.call(this"+(args.node?","+args:"")+")"}});return pro.gen_code(pro.ast_lift_variables(jsp.parse(program.compile())),{beautify:true,indent_level:2})}Object.define(Tree.prototype,{compile:function(){var src=this.raw();this.children.reverse().forEach(function(child){var raw=child.raw(),start=src.indexOf(raw),end=start+raw.length;src=src.substring(0,start)+child.compile()+src.substring(end)});return src},context:function(){var ctx=new Context(this);return ctx}});function Context(node){var stack=Object.create(node);Object.define(stack,node.ast);Object.define(stack,{node:node,get parent(){if(node.parent)return node.parent.context()}});if(stack.hasOwnProperty("loc"))delete stack["loc"];node.children.forEach(function(child){var ctx=child.context();Object.defineProperty(stack,child.key,{get:function(){return ctx},enumerable:true})});return stack}exports.rewrite=rewrite};require["./six"]=new function(){var exports=this;var rewrite,harmonize,moduleStyles,run,fs=require("fs"),path=require("path"),harmonizr=require("./harmonizr");require("./es6");rewrite=require("./rewriter").rewrite;harmonize=exports.harmonize=harmonizr.harmonize;moduleStyles=exports.modulesStyles=harmonizr.modulesStyles;run=exports.run=function(code,options){var mainModule=require.main;if(!options)options={};mainModule.filename=process.argv[1]=options.filename?fs.realpathSync(options.filename):".";mainModule.moduleCache&&(mainModule.moduleCache={});mainModule.paths=require("module")._nodeModulePaths(path.dirname(fs.realpathSync(options.filename)));if(path.extname(mainModule.filename)!==".js"||require.extensions){mainModule._compile(compile(code,options),mainModule.filename)}else{mainModule._compile(code,mainModule.filename)}};function compile(src,options){src=harmonize(src,options);src=rewrite(src);return src}exports.compile=compile};require["./browser"]=new function(){var exports=this;var runScripts;Six=require("./six");Six.require=require;Six.eval=function(code,options){return eval(Six.compile(code,options))};Six.run=function(code,options){Function(Six.compile(code,options))()};Six.load=function(url,callback){var xhr=window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;xhr.open("GET",url,true);if("overrideMimeType"in xhr)xhr.overrideMimeType("text/plain");xhr.onreadystatechange=function(){if(xhr.readyState===4){if(xhr.status===200||xhr.status===0)Six.run(xhr.responseText);else throw new Error("Could not load "+url);callback&&callback()}};xhr.send(null)};runScripts=function(){var scripts=document.getElementsByTagName("script");var sixes=[];sixes.forEach.call(scripts,function(s){return s.type==="text/six"&&sixes.push(s)});var index=0;var length=sixes.length;var execute=function(){var script=sixes[index++];if(script&&script.type==="text/six"){if(script.src)Six.load(script.src,execute);else{Six.run(script.innerHTML);execute()}}};execute();return null};if(window.addEventListener)window.addEventListener("DOMContentLoaded",runScripts,false);else window.attachEvent("onload",runScripts)};return require["./six"]}();if(typeof define==="function"&&define.amd){define(function(){return Six})}else{global.Six=Six}})(typeof global!=="undefined"?global:this)